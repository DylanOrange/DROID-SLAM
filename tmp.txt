Namespace(name='test', ckpt='droid.pth', datasets=None, datapath='/storage/slurm/xiny/dataset/cofusion/own/dataset', gpus=1, batch=1, iters=1, steps=160000, lr=0.00025, clip=2.5, n_frames=7, w1=10.0, w2=0.01, w3=0.05, fmin=8.0, fmax=96.0, obfmin=32.0, obfmax=96.0, noise=False, scale=False, edges=24, restart_prob=0.01, world_size=1)
Dataset own has 2249 images
Dataset own has 2249 images
scene is apartment0_car
trackid is 1
frames are [135 152 175 147 113 148 130]
camera frames are [135 152 175 147 113 148 130]
scene is room0_jeep
trackid is 1
frames are [454 456 465 467 469 443 445]
camera frames are [467 469 478 480 482 456 458]
scene is apartment0_car
trackid is 1
frames are [426 434 442 451 460 451 460]
camera frames are [426 434 442 451 460 451 460]
scene is room0_jeep
trackid is 1
frames are [334 343 352 361 370 379 388]
camera frames are [347 356 365 374 383 392 401]
scene is apartment5_car
trackid is 1
frames are [303 272 300 272 302 271 326]
camera frames are [303 272 300 272 302 271 326]
scene is apartment0_car
trackid is 1
frames are [135 150 168 143 111  91  39]
camera frames are [135 150 168 143 111  91  39]
scene is room0_jeep
trackid is 1
frames are [443 433 444 433 443 453 441]
camera frames are [456 446 457 446 456 466 454]
scene is room0_jeep
trackid is 1
frames are [225 227 230 231 234 217 222]
camera frames are [226 229 232 235 239 218 223]
scene is apartment5_car
trackid is 1
frames are [ 54 101  58  14  48  23  56]
camera frames are [ 54 101  58  14  48  23  56]
scene is room2_car
trackid is 1
frames are [447 450 452 456 461 453 462]
camera frames are [523 526 528 532 537 529 538]
scene is room2_car
trackid is 1
frames are [492 511 493 507 489 515 490]
camera frames are [568 587 569 583 565 591 566]
scene is room0_jeep
trackid is 1
frames are [128 130 132 134 135 138 142]
camera frames are [129 131 133 135 136 139 143]
scene is room0_jeep
trackid is 1
frames are [231 234 235 239 240 242 244]
camera frames are [235 239 241 245 246 248 250]
scene is room0_car
trackid is 1
frames are [120 127 133 139 146 152 157]
camera frames are [120 127 133 139 146 152 157]
scene is room0_jeep
trackid is 1
frames are [214 218 222 231 240 236 240]
camera frames are [215 219 223 235 246 242 246]
scene is room2_car
trackid is 1
frames are [196 203 207 175 183 187 191]
camera frames are [266 273 277 245 253 257 261]
scene is room2_car
trackid is 1
frames are [108 117 126 131 136 143 150]
camera frames are [177 186 195 200 205 212 220]
scene is room0_jeep
trackid is 1
frames are [20 45 54 63 72 81 90]
camera frames are [20 45 54 63 72 82 91]
scene is room2_car
trackid is 1
frames are [311 320 328 333 341 350 356]
camera frames are [383 392 400 405 413 422 428]
scene is room0_jeep
trackid is 1
frames are [ 71  76  84  93 102 111 120]
camera frames are [ 71  76  85  94 103 112 121]
scene is room0_jeep
trackid is 1
frames are [483 463 451 441 452 442 454]
camera frames are [496 476 464 454 465 455 467]
scene is apartment0_car
trackid is 1
frames are [368 377 386 393 400 409 417]
camera frames are [368 377 386 393 400 409 417]
scene is apartment0_car
trackid is 1
frames are [113 136 154 183 202 210 217]
camera frames are [113 136 154 183 202 210 217]
scene is room2_car
trackid is 1
frames are [143 147 156 163 170 179 172]
camera frames are [212 217 226 233 240 249 242]
scene is room2_car
trackid is 1
frames are [322 331 337 341 348 353 359]
camera frames are [394 403 409 413 420 425 435]
scene is apartment5_car
trackid is 1
frames are [44  6 23 44 22 48 14]
camera frames are [44  6 23 44 22 48 14]
scene is room2_car
trackid is 1
frames are [421 427 432 438 444 447 451]
camera frames are [497 503 508 514 520 523 527]
scene is apartment5_car
trackid is 1
frames are [383 417 377 430 356 396 457]
camera frames are [384 418 377 431 356 397 458]
scene is apartment5_car
trackid is 1
frames are [45 26 65 93 73 39 84]
camera frames are [45 26 65 93 73 39 84]
scene is apartment0_car
trackid is 1
frames are [258 263 269 271 272 279 254]
camera frames are [258 263 269 271 272 279 254]
scene is room2_car
trackid is 1
frames are [458 461 464 467 468 470 472]
camera frames are [534 537 540 543 544 546 548]
scene is apartment5_car
trackid is 1
frames are [102 128 110  89  60  43  87]
camera frames are [102 128 110  89  60  43  87]
scene is room2_car
trackid is 1
frames are [188 191 200 209 200 209 207]
camera frames are [258 261 270 279 270 279 277]
scene is room2_car
trackid is 1
frames are [342 351 356 359 368 377 386]
camera frames are [414 423 428 435 444 453 462]
scene is apartment5_car
trackid is 1
frames are [106  73  35  62  93  48  27]
camera frames are [106  73  35  62  93  48  27]
scene is apartment0_car
trackid is 1
frames are [485 490 491 493 494 496 497]
camera frames are [485 490 491 493 494 496 497]
scene is apartment5_car
trackid is 1
frames are [ 89  43  78 111  67  26   9]
camera frames are [ 89  43  78 111  67  26   9]
scene is room0_jeep
trackid is 1
frames are [271 280 289 296 303 311 320]
camera frames are [279 288 297 306 315 324 333]
scene is room2_car
trackid is 1
frames are [18 38 16 49 55 60 55]
camera frames are [18 38 16 49 55 60 55]
scene is apartment5_car
trackid is 1
frames are [31 62 28 55 28  0 29]
camera frames are [31 62 28 55 28  0 29]
scene is room2_car
trackid is 1
frames are [201 210 207 212 221 212 221]
camera frames are [271 280 277 282 292 282 292]
scene is apartment0_car
trackid is 1
frames are [264 269 276 283 275 283 275]
camera frames are [264 269 276 283 275 283 275]
scene is room0_car
trackid is 1
frames are [121 127 133 139 146 153 159]
camera frames are [121 127 133 139 146 153 159]
scene is room0_car
trackid is 1
frames are [ 4 26 35 43 50 59 63]
camera frames are [ 4 26 35 43 50 59 63]
scene is room2_car
trackid is 1
frames are [104 110 118 124 131 140 142]
camera frames are [173 179 187 193 200 209 211]
scene is apartment0_car
trackid is 1
frames are [287 279 287 278 286 277 286]
camera frames are [287 279 287 278 286 277 286]
scene is room2_car
trackid is 1
frames are [137 144 153 162 170 179 170]
camera frames are [206 213 223 232 240 249 240]
scene is room0_jeep
trackid is 1
frames are [130 139 147 138 146 155 146]
camera frames are [131 140 148 139 147 156 147]
scene is room0_car
trackid is 1
frames are [143 150 155 161 166 170 175]
camera frames are [143 150 155 161 166 170 175]
scene is apartment0_car
trackid is 1
frames are [118 153 176 162 133 151 120]
camera frames are [118 153 176 162 133 151 120]
scene is room2_car
trackid is 1
frames are [75 79 86 92 96 87 94]
camera frames are [116 120 127 133 137 128 135]
scene is room0_car
trackid is 1
frames are [58 65 71 80 85 91 98]
camera frames are [58 65 71 80 85 91 98]
scene is room0_jeep
trackid is 1
frames are [225 261 230 236 244 253 221]
camera frames are [226 267 232 242 250 259 222]
scene is apartment5_car
trackid is 1
frames are [223 228 234 243 234 242 233]
camera frames are [223 228 234 243 234 242 233]
scene is room2_car
trackid is 1
frames are [436 442 446 449 451 453 460]
camera frames are [512 518 522 525 527 529 536]
scene is room0_jeep
trackid is 1
frames are [473 462 451 441 431 421 412]
camera frames are [486 475 464 454 444 434 425]
scene is apartment5_car
trackid is 1
frames are [397 447 383 431 363 432 479]
camera frames are [398 448 384 432 363 433 481]
scene is apartment0_car
trackid is 1
frames are [390 397 404 410 417 424 433]
camera frames are [390 397 404 410 417 424 433]
scene is apartment5_car
trackid is 1
frames are [112  79 112  80 119  87  67]
camera frames are [112  79 112  80 119  87  67]
scene is room2_car
trackid is 1
frames are [32 38 39 45 46 49 53]
camera frames are [32 38 39 45 46 49 53]
scene is room0_car
trackid is 1
frames are [182 189 194 198 205 211 219]
camera frames are [182 189 194 198 205 211 219]
scene is room0_car
trackid is 1
frames are [291 296 298 268 276 280 286]
camera frames are [291 296 298 268 276 280 286]
scene is apartment5_car
trackid is 1
frames are [ 57  25  63  21  65 102  82]
camera frames are [ 57  25  63  21  65 102  82]
scene is room0_car
trackid is 1
frames are [261 267 270 271 274 276 280]
camera frames are [261 267 270 271 274 276 280]
scene is apartment5_car
trackid is 1
frames are [382 346 409 365 422 457 403]
camera frames are [383 346 410 365 423 458 404]
scene is apartment0_car
trackid is 1
frames are [223 231 238 246 252 256 264]
camera frames are [223 231 238 246 252 256 264]
scene is apartment0_car
trackid is 1
frames are [ 65  27  68  94 123 156 138]
camera frames are [ 65  27  68  94 123 156 138]
scene is apartment0_car
trackid is 1
frames are [ 88 121 104  81  99  67  22]
camera frames are [ 88 121 104  81  99  67  22]
scene is apartment0_car
trackid is 1
frames are [97 67 98 65 13 41 86]
camera frames are [97 67 98 65 13 41 86]
scene is room2_car
trackid is 1
frames are [375 384 392 401 409 417 425]
camera frames are [451 460 468 477 485 493 501]
scene is room0_jeep
trackid is 1
frames are [42 51 60 69 78 87 96]
camera frames are [42 51 60 69 79 88 97]
scene is apartment5_car
trackid is 1
frames are [468 391 352 435 397 439 390]
camera frames are [469 392 352 436 398 440 391]
scene is apartment0_car
trackid is 1
frames are [179 147 169 138 116 144 116]
camera frames are [179 147 169 138 116 144 116]
scene is room2_car
trackid is 1
frames are [336 345 349 357 360 368 377]
camera frames are [408 417 421 429 436 444 453]
scene is apartment0_car
trackid is 1
frames are [254 260 269 277 285 277 284]
camera frames are [254 260 269 277 285 277 284]
scene is apartment0_car
trackid is 1
frames are [247 255 263 271 278 287 278]
camera frames are [247 255 263 271 278 287 278]
scene is apartment0_car
trackid is 1
frames are [419 420 423 426 427 433 441]
camera frames are [419 420 423 426 427 433 441]
scene is room0_jeep
trackid is 1
frames are [334 343 352 361 370 379 388]
camera frames are [347 356 365 374 383 392 401]
scene is apartment5_car
trackid is 1
frames are [303 272 317 279 329 282 317]
camera frames are [303 272 317 279 329 282 317]
scene is room2_car
trackid is 1
frames are [258 261 264 267 269 271 274]
camera frames are [329 332 335 339 341 343 346]
scene is room2_car
trackid is 1
frames are [389 398 407 414 421 430 437]
camera frames are [465 474 483 490 497 506 513]
scene is room0_car
trackid is 1
frames are [263 269 270 275 278 283 286]
camera frames are [263 269 270 275 278 283 286]
scene is room0_jeep
trackid is 1
frames are [ 69  78  87  96 105 114 123]
camera frames are [ 69  79  88  97 106 115 124]
scene is room0_jeep
trackid is 1
frames are [309 318 327 336 345 354 363]
camera frames are [322 331 340 349 358 367 376]
scene is room2_car
trackid is 1
frames are [152 156 164 172 179 172 180]
camera frames are [222 226 234 242 249 242 250]
scene is apartment5_car
trackid is 1
frames are [416 363 429 472 395 442 405]
camera frames are [417 363 430 473 396 443 406]
scene is apartment5_car
trackid is 1
frames are [28 65 46 18 63 35  0]
camera frames are [28 65 46 18 63 35  0]
scene is apartment0_car
trackid is 1
frames are [424 432 440 449 458 449 458]
camera frames are [424 432 440 449 458 449 458]
scene is apartment5_car
trackid is 1
frames are [352 434 470 426 346 387 423]
camera frames are [352 435 471 427 346 388 424]
scene is room0_jeep
trackid is 1
frames are [388 390 391 395 396 402 404]
camera frames are [401 403 404 408 409 415 417]
scene is room2_car
trackid is 1
frames are [103 110 119 125 133 138 145]
camera frames are [172 179 188 194 202 207 215]
scene is room0_jeep
trackid is 1
frames are [475 463 452 441 451 462 475]
camera frames are [488 476 465 454 464 475 488]
scene is apartment0_car
trackid is 1
frames are [490 463 491 471 493 473 485]
camera frames are [490 463 491 471 493 473 485]
scene is apartment0_car
trackid is 1
frames are [380 387 396 404 410 419 426]
camera frames are [380 387 396 404 410 419 426]
scene is room2_car
trackid is 1
frames are [239 251 255 258 256 260 257]
camera frames are [310 322 326 329 327 331 328]
scene is apartment0_car
trackid is 1
frames are [484 490 491 493 496 497 499]
camera frames are [484 490 491 493 496 497 499]
scene is room2_car
trackid is 1
frames are [114 122 131 136 143 149 155]
camera frames are [183 191 200 205 212 219 225]
scene is apartment5_car
trackid is 1
frames are [462 386 430 390 352 436 372]
camera frames are [463 387 431 391 352 437 372]
scene is apartment0_car
trackid is 1
frames are [351 358 365 370 377 383 390]
camera frames are [351 358 365 370 377 383 390]
scene is apartment5_car
trackid is 1
frames are [401 366 425 380 437 355 424]
camera frames are [402 366 426 381 438 355 425]
scene is room0_jeep
trackid is 1
frames are [192 194 195 196 199 203 187]
camera frames are [193 195 196 197 200 204 188]
scene is room0_car
trackid is 1
frames are [199 207 212 217 225 233 240]
camera frames are [199 207 212 217 225 233 240]
scene is apartment0_car
trackid is 1
frames are [208 217 223 229 234 243 250]
camera frames are [208 217 223 229 234 243 250]
scene is room0_jeep
trackid is 1
frames are [317 326 335 344 353 362 371]
camera frames are [330 339 348 357 366 375 384]
scene is room2_car
trackid is 1
frames are [72 79 86 90 95 91 95]
camera frames are [113 120 127 131 136 132 136]
scene is room0_jeep
trackid is 1
frames are [364 373 382 391 400 409 418]
camera frames are [377 386 395 404 413 422 431]
scene is apartment5_car
trackid is 1
frames are [424 374 449 409 356 426 363]
camera frames are [425 374 450 410 356 427 363]
scene is room2_car
trackid is 1
frames are [260 262 244 246 251 253 255]
camera frames are [331 333 315 317 322 324 326]
scene is room2_car
trackid is 1
frames are [254 257 259 257 260 256 258]
camera frames are [325 328 330 328 331 327 329]
scene is room2_car
trackid is 1
frames are [481 483 484 489 466 474 478]
camera frames are [557 559 560 565 542 550 554]
scene is apartment5_car
trackid is 1
frames are [300 272 327 288 327 277 314]
camera frames are [300 272 327 288 327 277 314]
scene is room2_car
trackid is 1
frames are [106 114 122 128 136 143 149]
camera frames are [175 183 191 197 205 212 219]
scene is room2_car
trackid is 1
frames are [296 313 322 330 336 343 348]
camera frames are [368 385 394 402 408 415 420]
scene is apartment5_car
trackid is 1
frames are [298 271 326 280 314 278 316]
camera frames are [298 271 326 280 314 278 316]
scene is room0_jeep
trackid is 1
frames are [321 330 339 348 357 366 375]
camera frames are [334 343 352 361 370 379 388]
scene is room2_car
trackid is 1
frames are [435 442 444 447 450 453 455]
camera frames are [511 518 520 523 526 529 531]
scene is room0_jeep
trackid is 1
frames are [ 97 106 115 124 132 140 149]
camera frames are [ 98 107 116 125 133 141 150]
scene is room0_car
trackid is 1
frames are [180 186 192 200 208 212 218]
camera frames are [180 186 192 200 208 212 218]
scene is apartment0_car
trackid is 1
frames are [259 266 272 278 286 278 287]
camera frames are [259 266 272 278 286 278 287]
scene is room0_car
trackid is 1
frames are [28 37 46 55 64 71 78]
camera frames are [28 37 46 55 64 71 78]
scene is room2_car
trackid is 1
frames are [452 459 462 465 468 470 475]
camera frames are [528 535 538 541 544 546 551]
scene is room0_jeep
trackid is 1
frames are [134 143 148 149 152 155 156]
camera frames are [135 144 149 150 153 156 157]
scene is apartment0_car
trackid is 1
frames are [309 315 322 329 335 342 348]
camera frames are [309 315 322 329 335 342 348]
scene is room0_jeep
trackid is 1
frames are [194 200 203 206 176 181 185]
camera frames are [195 201 204 207 177 182 186]
scene is room0_jeep
trackid is 1
frames are [384 393 402 411 420 411 420]
camera frames are [397 406 415 424 433 424 433]
scene is apartment5_car
trackid is 1
frames are [67 31 14 43 73 45 84]
camera frames are [67 31 14 43 73 45 84]
scene is room0_car
trackid is 1
frames are [44 51 59 65 73 80 85]
camera frames are [44 51 59 65 73 80 85]
scene is apartment0_car
trackid is 1
frames are [ 9 41 62 27 64 36 80]
camera frames are [ 9 41 62 27 64 36 80]
scene is room2_car
trackid is 1
frames are [228 234 235 237 241 243 220]
camera frames are [299 305 306 308 312 314 291]
scene is room2_car
trackid is 1
frames are [501 519 508 486 473 464 472]
camera frames are [577 595 584 562 549 540 548]
scene is apartment5_car
trackid is 1
frames are [ 11  49  75  36  65  85 110]
camera frames are [ 11  49  75  36  65  85 110]
scene is room2_car
trackid is 1
frames are [438 441 444 446 449 452 457]
camera frames are [514 517 520 522 525 528 533]
scene is apartment0_car
trackid is 1
frames are [59 81 36 57 78 42 84]
camera frames are [59 81 36 57 78 42 84]
scene is room0_jeep
trackid is 1
frames are [245 233 242 233 236 240 236]
camera frames are [251 238 248 238 242 246 242]
scene is room0_jeep
trackid is 1
frames are [315 324 333 342 351 360 369]
camera frames are [328 337 346 355 364 373 382]
scene is room2_car
trackid is 1
frames are [308 317 326 334 343 352 357]
camera frames are [380 389 398 406 415 424 429]
scene is room2_car
trackid is 1
frames are [197 199 231 205 207 214 222]
camera frames are [267 269 302 275 277 284 293]
scene is room0_jeep
trackid is 1
frames are [45 54 63 72 80 89 98]
camera frames are [45 54 63 72 81 90 99]
scene is apartment0_car
trackid is 1
frames are [448 451 433 434 441 442 444]
camera frames are [448 451 433 434 441 442 444]
scene is apartment5_car
trackid is 1
frames are [385 431 347 389 355 424 392]
camera frames are [386 432 347 390 355 425 393]
scene is room0_car
trackid is 1
frames are [139 146 151 157 162 167 172]
camera frames are [139 146 151 157 162 167 172]
scene is room0_jeep
trackid is 1
frames are [23 49 58 67 76 85 94]
camera frames are [23 49 58 67 76 86 95]
scene is room0_jeep
trackid is 1
frames are [ 61  70  78  87  96 105 114]
camera frames are [ 61  70  79  88  97 106 115]
scene is room0_jeep
trackid is 1
frames are [226 205 211 214 216 220 222]
camera frames are [227 206 212 215 217 221 223]
scene is room0_car
trackid is 1
frames are [150 155 160 166 170 176 180]
camera frames are [150 155 160 166 170 176 180]
scene is room2_car
trackid is 1
frames are [202 205 211 212 216 217 221]
camera frames are [272 275 281 282 286 287 292]
scene is room2_car
trackid is 1
frames are [298 276 263 267 270 267 269]
camera frames are [370 348 334 339 342 339 341]
scene is room2_car
trackid is 1
frames are [510 498 523 511 495 510 497]
camera frames are [586 574 599 587 571 586 573]
-----
before optimization
geo loss is 3.612171395328545e-10
r_err is 8.860845390756822e-09
t_err is 2.0656620858261476e-10
ob_loss is 0.03127892315387726
ob_r_err is 0.5578837990760803
ob_t_err is 0.02154177986085415
-----
before, dynamic flow loss is 0.09131014347076416
predicted weight is 0.5045003294944763
predicted dynamic weight is 0.5300650596618652
predicted dynamic flow loss is 0.10441115498542786
predicted flow loss is 0.5052308440208435
predicted flow delta is 0.007571428548544645
first residual should be -0.0131010040640831
dyna residual is -0.0131010040640831
dyna residual is -0.005424346309155226
dyna residual is -0.005168118514120579
dyna residual is -0.005162953399121761
dyna residual is -0.00515811936929822
dyna residual is -0.0051599605940282345
dyna residual is -0.0051626465283334255
dyna residual is -0.005161545239388943
-----
after optimization
geo loss is 3.612171395328545e-10
r_err is 8.860845390756822e-09
t_err is 2.0656620858261476e-10
ob_loss is 0.05550017207860947
ob_r_err is 1.2218691110610962
ob_t_err is 0.03417327255010605
-----
bad optimization!
-----
before optimization
geo loss is 4.5874219978259134e-09
r_err is 1.269408045345699e-07
t_err is 2.371887353191937e-09
ob_loss is 0.14883840084075928
ob_r_err is 1.1210955381393433
ob_t_err is 0.1292671263217926
-----
before, dynamic flow loss is -0.6970474720001221
predicted weight is 0.07021114975214005
predicted dynamic weight is 0.12336447089910507
predicted dynamic flow loss is -0.09117637574672699
predicted flow loss is 5.490258693695068
predicted flow delta is -0.25275489687919617
first residual should be -0.6058710217475891
dyna residual is -0.6058710217475891
dyna residual is 3.5963540077209473
dyna residual is 6.313554286956787
dyna residual is 1.472161054611206
dyna residual is 0.0633382797241211
dyna residual is 0.1280352771282196
dyna residual is 0.10024545341730118
dyna residual is 0.09938778728246689
-----
after optimization
geo loss is 4.5874219978259134e-09
r_err is 1.269408045345699e-07
t_err is 2.371887353191937e-09
ob_loss is 0.4522925317287445
ob_r_err is 9.258655548095703
ob_t_err is 0.2902382016181946
-----
bad optimization!
-----
before optimization
geo loss is 4.234006478753827e-09
r_err is 7.553109782065803e-08
t_err is 2.9157403158563966e-09
ob_loss is 0.03224047273397446
ob_r_err is 0.0
ob_t_err is 0.03224047273397446
-----
before, dynamic flow loss is 0.0646045133471489
predicted weight is 0.029658323153853416
predicted dynamic weight is 0.05701112002134323
predicted dynamic flow loss is 0.58137047290802
predicted flow loss is 5.200534343719482
predicted flow delta is 0.12638619542121887
first residual should be -0.5167659521102905
dyna residual is -0.5167659521102905
dyna residual is -0.2812073528766632
dyna residual is -0.10274092108011246
dyna residual is -0.09000883251428604
dyna residual is -0.028599631041288376
dyna residual is -0.053733307868242264
dyna residual is -0.02025173418223858
dyna residual is -0.0475301593542099
-----
after optimization
geo loss is 4.234006478753827e-09
r_err is 7.553109782065803e-08
t_err is 2.9157403158563966e-09
ob_loss is 0.25167810916900635
ob_r_err is 5.649357795715332
ob_t_err is 0.15296748280525208
-----
bad optimization!
-----
before optimization
geo loss is 1.8018284642096205e-09
r_err is 4.244464335556586e-08
t_err is 1.0610295975155282e-09
ob_loss is 0.020199451595544815
ob_r_err is 5.383770258049481e-06
ob_t_err is 0.020199358463287354
-----
before, dynamic flow loss is 0.23305177688598633
predicted weight is 0.2064208984375
predicted dynamic weight is 0.24526828527450562
predicted dynamic flow loss is 0.10583598166704178
predicted flow loss is 3.233461856842041
predicted flow delta is 0.014107611030340195
first residual should be 0.12721580266952515
dyna residual is 0.12721580266952515
dyna residual is -0.05893751233816147
dyna residual is 0.06583888083696365
dyna residual is 0.05944829806685448
dyna residual is 0.09246107190847397
dyna residual is 0.07852289825677872
dyna residual is 0.09215398132801056
dyna residual is 0.08363107591867447
-----
after optimization
geo loss is 1.8018284642096205e-09
r_err is 4.244464335556586e-08
t_err is 1.0610295975155282e-09
ob_loss is 0.16205734014511108
ob_r_err is 3.70344614982605
ob_t_err is 0.0973949059844017
-----
bad optimization!
-----
before optimization
geo loss is 4.8065440516609215e-09
r_err is 6.77876812460454e-08
t_err is 3.6234257816403215e-09
ob_loss is 0.11920112371444702
ob_r_err is 0.9713126420974731
ob_t_err is 0.10224546492099762
-----
before, dynamic flow loss is 0.03182871639728546
predicted weight is 0.19730642437934875
predicted dynamic weight is 0.16341450810432434
predicted dynamic flow loss is -0.5019615292549133
predicted flow loss is 4.037776470184326
predicted flow delta is 0.009209354408085346
first residual should be 0.5337902307510376
dyna residual is 0.5337902307510376
dyna residual is 0.003824810031801462
dyna residual is 0.2952914237976074
dyna residual is -0.4225865304470062
dyna residual is -0.10825519263744354
dyna residual is -0.11205172538757324
dyna residual is -0.11223992705345154
dyna residual is -0.11350838094949722
-----
after optimization
geo loss is 4.382065554864312e-08
r_err is 6.133117267381749e-07
t_err is 3.31163469979856e-08
ob_loss is 0.8958011865615845
ob_r_err is 18.101396560668945
ob_t_err is 0.5681529641151428
-----
bad optimization!
-----
before optimization
geo loss is 1.8096120157906626e-09
r_err is 2.874706162003804e-08
t_err is 1.3078811367250864e-09
ob_loss is 0.027663715183734894
ob_r_err is 0.4536447525024414
ob_t_err is 0.019745901226997375
-----
before, dynamic flow loss is -0.09812002629041672
predicted weight is 0.22983913123607635
predicted dynamic weight is 0.28264129161834717
predicted dynamic flow loss is 0.35717445611953735
predicted flow loss is 2.7612929344177246
predicted flow delta is 0.08771813660860062
first residual should be -0.45529448986053467
dyna residual is -0.45529448986053467
dyna residual is -0.09400398284196854
dyna residual is -0.13861067593097687
dyna residual is -0.11519898474216461
dyna residual is -0.1172536239027977
dyna residual is -0.11524441093206406
dyna residual is -0.11502309888601303
dyna residual is -0.11479295045137405
-----
after optimization
geo loss is 1.8096120157906626e-09
r_err is 2.874706162003804e-08
t_err is 1.3078811367250864e-09
ob_loss is 0.1418873518705368
ob_r_err is 3.94087290763855
ob_t_err is 0.07303551584482193
-----
bad optimization!
-----
before optimization
geo loss is 4.029892863854911e-09
r_err is 9.065094275229058e-08
t_err is 2.4477355697882786e-09
ob_loss is 0.09983289241790771
ob_r_err is 0.5179334878921509
ob_t_err is 0.0907926857471466
-----
before, dynamic flow loss is 0.22800669074058533
predicted weight is 0.13638313114643097
predicted dynamic weight is 0.13729092478752136
predicted dynamic flow loss is 0.08550956100225449
predicted flow loss is 3.8097739219665527
predicted flow delta is -0.027983231469988823
first residual should be 0.14249713718891144
dyna residual is 0.14249713718891144
dyna residual is -0.16753628849983215
dyna residual is 0.08426189422607422
dyna residual is 0.1577320247888565
dyna residual is 0.1652686595916748
dyna residual is 0.16454625129699707
dyna residual is 0.1650487780570984
dyna residual is 0.16458100080490112
-----
after optimization
geo loss is 4.029892863854911e-09
r_err is 9.065094275229058e-08
t_err is 2.4477355697882786e-09
ob_loss is 0.46047312021255493
ob_r_err is 6.455379962921143
ob_t_err is 0.34741389751434326
-----
bad optimization!
-----
before optimization
geo loss is 2.7254665191378535e-09
r_err is 5.481624398839813e-08
t_err is 1.7687424858081613e-09
ob_loss is 0.09972099959850311
ob_r_err is 0.0
ob_t_err is 0.09972099959850311
-----
before, dynamic flow loss is 0.38232913613319397
predicted weight is 0.32079386711120605
predicted dynamic weight is 0.1127200648188591
predicted dynamic flow loss is 0.061123915016651154
predicted flow loss is 2.8924643993377686
predicted flow delta is 0.20981484651565552
first residual should be 0.321205198764801
dyna residual is 0.321205198764801
dyna residual is 1.1402865648269653
dyna residual is -0.12605655193328857
dyna residual is 0.18522679805755615
dyna residual is 0.11810806393623352
dyna residual is 0.09357251971960068
dyna residual is 0.06586894392967224
dyna residual is 0.060196392238140106
-----
after optimization
geo loss is 2.7254665191378535e-09
r_err is 5.481624398839813e-08
t_err is 1.7687424858081613e-09
ob_loss is 1.1008342504501343
ob_r_err is 23.357980728149414
ob_t_err is 0.6798254251480103
-----
bad optimization!
-----
before optimization
geo loss is 3.627387057392184e-09
r_err is 1.3448075719679764e-07
t_err is 1.2802552351587337e-09
ob_loss is 0.5119428038597107
ob_r_err is 7.738371849060059
ob_t_err is 0.3763740062713623
-----
before, dynamic flow loss is 0.006138264667242765
predicted weight is 0.1403905749320984
predicted dynamic weight is 0.1199931874871254
predicted dynamic flow loss is 0.0014054562197998166
predicted flow loss is 4.248058795928955
predicted flow delta is -0.1509062945842743
first residual should be 0.004732827190309763
dyna residual is 0.004732827190309763
dyna residual is 0.12689892947673798
dyna residual is 0.027053890749812126
dyna residual is 0.021201174706220627
dyna residual is 0.016927126795053482
dyna residual is 0.015001692809164524
dyna residual is 0.014987636357545853
dyna residual is 0.014855057932436466
-----
after optimization
geo loss is 3.627387057392184e-09
r_err is 1.3448075719679764e-07
t_err is 1.2802552351587337e-09
ob_loss is 2.13985276222229
ob_r_err is 18.003326416015625
ob_t_err is 1.803081750869751
-----
bad optimization!
-----
before optimization
geo loss is 2.0871884220952097e-09
r_err is 9.298582881456241e-08
t_err is 4.6427958699801763e-10
ob_loss is 0.2598611116409302
ob_r_err is 7.698877811431885
ob_t_err is 0.1252899020910263
-----
before, dynamic flow loss is 0.4784821569919586
predicted weight is 0.22702762484550476
predicted dynamic weight is 0.27679547667503357
predicted dynamic flow loss is 0.6483049988746643
predicted flow loss is 2.8226418495178223
predicted flow delta is -0.11426391452550888
first residual should be -0.16982288658618927
dyna residual is -0.16982288658618927
dyna residual is -0.008730940520763397
dyna residual is -0.02421155758202076
dyna residual is -0.02501286379992962
dyna residual is -0.02547781728208065
dyna residual is -0.025257490575313568
dyna residual is -0.025381721556186676
dyna residual is -0.025309016928076744
-----
after optimization
geo loss is 2.0871884220952097e-09
r_err is 9.298582881456241e-08
t_err is 4.6427958699801763e-10
ob_loss is 0.2634578049182892
ob_r_err is 7.931600570678711
ob_t_err is 0.12489145994186401
-----
bad optimization!
-----
before optimization
geo loss is 1.6971566374479607e-09
r_err is 3.298535133922087e-08
t_err is 1.1214537076753572e-09
ob_loss is 0.04692051187157631
ob_r_err is 0.28704363107681274
ob_t_err is 0.0419105589389801
-----
before, dynamic flow loss is 0.030446985736489296
predicted weight is 0.44432029128074646
predicted dynamic weight is 0.33277907967567444
predicted dynamic flow loss is -0.10755827277898788
predicted flow loss is 1.3154546022415161
predicted flow delta is -0.007813329808413982
first residual should be 0.13800525665283203
dyna residual is 0.13800525665283203
dyna residual is 0.11718825250864029
dyna residual is 0.09259546548128128
dyna residual is 0.10247327387332916
dyna residual is 0.08997298777103424
dyna residual is 0.09411635249853134
dyna residual is 0.0911385789513588
dyna residual is 0.09189047664403915
-----
after optimization
geo loss is 1.6971566374479607e-09
r_err is 3.298535133922087e-08
t_err is 1.1214537076753572e-09
ob_loss is 0.16512218117713928
ob_r_err is 2.422031879425049
ob_t_err is 0.12283585965633392
-----
bad optimization!
-----
before optimization
geo loss is 6.790762174802012e-09
r_err is 2.401660026407626e-07
t_err is 2.599074733211637e-09
ob_loss is 0.2428566813468933
ob_r_err is 0.6475348472595215
ob_t_err is 0.23155196011066437
-----
before, dynamic flow loss is 0.38941526412963867
predicted weight is 0.13449086248874664
predicted dynamic weight is 0.23276248574256897
predicted dynamic flow loss is 0.3685019910335541
predicted flow loss is 4.450860023498535
predicted flow delta is 0.2762761116027832
first residual should be 0.020913265645503998
dyna residual is 0.020913265645503998
dyna residual is -0.1561218798160553
dyna residual is -0.013497739098966122
dyna residual is -0.05520681291818619
dyna residual is -0.051688358187675476
dyna residual is -0.04790201038122177
dyna residual is -0.05183856189250946
dyna residual is -0.04074616730213165
-----
after optimization
geo loss is 6.790762174802012e-09
r_err is 2.401660026407626e-07
t_err is 2.599074733211637e-09
ob_loss is 1.7707502841949463
ob_r_err is 21.433765411376953
ob_t_err is 1.3782932758331299
-----
bad optimization!
-----
before optimization
geo loss is 1.8343766505779513e-09
r_err is 6.962937959542614e-08
t_err is 6.191147039480427e-10
ob_loss is 0.057398490607738495
ob_r_err is 1.6849479675292969
ob_t_err is 0.027988890185952187
-----
before, dynamic flow loss is 0.1849861890077591
predicted weight is 0.037541501224040985
predicted dynamic weight is 0.10899030417203903
predicted dynamic flow loss is -0.02500413917005062
predicted flow loss is 6.244139671325684
predicted flow delta is -0.3870656490325928
first residual should be 0.20999030768871307
dyna residual is 0.20999030768871307
dyna residual is 0.1834416687488556
dyna residual is 0.1857847422361374
dyna residual is 0.18432332575321198
dyna residual is 0.18471483886241913
dyna residual is 0.1847083419561386
dyna residual is 0.18486256897449493
dyna residual is 0.18490436673164368
-----
after optimization
geo loss is 1.8343766505779513e-09
r_err is 6.962937959542614e-08
t_err is 6.191147039480427e-10
ob_loss is 0.15417128801345825
ob_r_err is 5.2484002113342285
ob_t_err is 0.06253756582736969
-----
bad optimization!
-----
before optimization
geo loss is 6.11813488760049e-10
r_err is 1.8065353657448213e-08
t_err is 2.965135914578809e-10
ob_loss is 0.01597285270690918
ob_r_err is 0.5045690536499023
ob_t_err is 0.00716641079634428
-----
before, dynamic flow loss is 0.01113976538181305
predicted weight is 0.35105615854263306
predicted dynamic weight is 0.5818141102790833
predicted dynamic flow loss is 0.005575747694820166
predicted flow loss is 1.4964169263839722
predicted flow delta is -0.046370282769203186
first residual should be 0.005564018152654171
dyna residual is 0.005564018152654171
dyna residual is 0.0054955328814685345
dyna residual is 0.0054983957670629025
dyna residual is 0.00548728508874774
dyna residual is 0.005494500510394573
dyna residual is 0.00548994354903698
dyna residual is 0.005494873039424419
dyna residual is 0.00549373310059309
-----
after optimization
geo loss is 6.11813488760049e-10
r_err is 1.8065353657448213e-08
t_err is 2.965135914578809e-10
ob_loss is 0.03877273574471474
ob_r_err is 1.4722017049789429
ob_t_err is 0.013077287934720516
-----
bad optimization!
-----
before optimization
geo loss is 3.512758528501081e-09
r_err is 8.236545312456656e-08
t_err is 2.075210447927134e-09
ob_loss is 0.03197701647877693
ob_r_err is 3.619024937506765e-06
ob_t_err is 0.03197695314884186
-----
before, dynamic flow loss is -0.05030188336968422
predicted weight is 0.02960919961333275
predicted dynamic weight is 0.05394218489527702
predicted dynamic flow loss is 0.4584832489490509
predicted flow loss is 5.214162349700928
predicted flow delta is 0.09912844002246857
first residual should be -0.5087851881980896
dyna residual is -0.5087851881980896
dyna residual is -0.16894596815109253
dyna residual is -0.0445074588060379
dyna residual is -0.09309160709381104
dyna residual is 0.04190073534846306
dyna residual is -0.10547510534524918
dyna residual is 0.09397896379232407
dyna residual is -0.11546772718429565
-----
after optimization
geo loss is 3.512758528501081e-09
r_err is 8.236545312456656e-08
t_err is 2.075210447927134e-09
ob_loss is 0.3985001742839813
ob_r_err is 9.404775619506836
ob_t_err is 0.23383258283138275
-----
bad optimization!
-----
before optimization
geo loss is 7.219632669475118e-10
r_err is 1.519146763939716e-08
t_err is 4.568221356748836e-10
ob_loss is 0.008078900165855885
ob_r_err is 0.04674750193953514
ob_t_err is 0.007263001520186663
-----
before, dynamic flow loss is -0.008859694935381413
predicted weight is 0.39565736055374146
predicted dynamic weight is 0.50944983959198
predicted dynamic flow loss is 0.03810414299368858
predicted flow loss is 1.4431309700012207
predicted flow delta is -0.04096771404147148
first residual should be -0.04696383699774742
dyna residual is -0.04696383699774742
dyna residual is -0.040558237582445145
dyna residual is -0.04096125811338425
dyna residual is -0.04100779816508293
dyna residual is -0.04102465137839317
dyna residual is -0.041026629507541656
dyna residual is -0.0410303920507431
dyna residual is -0.04102723300457001
-----
after optimization
geo loss is 7.219632669475118e-10
r_err is 1.519146763939716e-08
t_err is 4.568221356748836e-10
ob_loss is 0.027899403125047684
ob_r_err is 0.9843408465385437
ob_t_err is 0.010719026438891888
-----
bad optimization!
-----
before optimization
geo loss is 2.2070396621387545e-09
r_err is 1.1382084608158038e-07
t_err is 2.2049116699118798e-10
ob_loss is 0.24175739288330078
ob_r_err is 4.862964630126953
ob_t_err is 0.15675538778305054
-----
before, dynamic flow loss is -0.44128474593162537
predicted weight is 0.1707889288663864
predicted dynamic weight is 0.12380121648311615
predicted dynamic flow loss is -0.36626648902893066
predicted flow loss is 3.546189546585083
predicted flow delta is 0.05109700560569763
first residual should be -0.07501823455095291
dyna residual is -0.07501823455095291
dyna residual is -0.08735406398773193
dyna residual is -0.08434177935123444
dyna residual is -0.08353587985038757
dyna residual is -0.08152760565280914
dyna residual is -0.08145097643136978
dyna residual is -0.08075264096260071
dyna residual is -0.08060397207736969
-----
after optimization
geo loss is 2.2070396621387545e-09
r_err is 1.1382084608158038e-07
t_err is 2.2049116699118798e-10
ob_loss is 0.3818635046482086
ob_r_err is 4.622552394866943
ob_t_err is 0.3010464608669281
-----
bad optimization!
-----
before optimization
geo loss is 1.1191418902711803e-09
r_err is 2.4686736210810523e-08
t_err is 6.882771574900914e-10
ob_loss is 0.234604150056839
ob_r_err is 8.887059211730957
ob_t_err is 0.07935799658298492
-----
before, dynamic flow loss is 0.6914145946502686
predicted weight is 0.6645740270614624
predicted dynamic weight is 0.06149841845035553
predicted dynamic flow loss is 0.4620705842971802
predicted flow loss is 1.2274636030197144
predicted flow delta is -0.001241020392626524
first residual should be 0.2293439656496048
dyna residual is 0.2293439656496048
dyna residual is 0.1708812564611435
dyna residual is 0.14121153950691223
dyna residual is 0.06411010026931763
dyna residual is 0.0654802918434143
dyna residual is 0.04894879460334778
dyna residual is 0.05502425879240036
dyna residual is 0.05198970437049866
-----
after optimization
geo loss is 1.1191418902711803e-09
r_err is 2.4686736210810523e-08
t_err is 6.882771574900914e-10
ob_loss is 0.8185232877731323
ob_r_err is 21.066919326782227
ob_t_err is 0.4467051327228546
-----
bad optimization!
-----
before optimization
geo loss is 2.0658021959718553e-09
r_err is 9.296155667470885e-08
t_err is 4.4331691095855774e-10
ob_loss is 0.2149670124053955
ob_r_err is 0.2795228660106659
ob_t_err is 0.2100878655910492
-----
before, dynamic flow loss is 1.710408329963684
predicted weight is 0.13197582960128784
predicted dynamic weight is 0.2239154875278473
predicted dynamic flow loss is 1.8491426706314087
predicted flow loss is 4.825507640838623
predicted flow delta is 0.257297545671463
first residual should be -0.13873423635959625
dyna residual is -0.13873423635959625
dyna residual is -0.20253217220306396
dyna residual is -0.2196653187274933
dyna residual is -0.2063339799642563
dyna residual is -0.2078569084405899
dyna residual is -0.20644383132457733
dyna residual is -0.20679143071174622
dyna residual is -0.20663397014141083
-----
after optimization
geo loss is 2.0658021959718553e-09
r_err is 9.296155667470885e-08
t_err is 4.4331691095855774e-10
ob_loss is 0.5269109010696411
ob_r_err is 5.179690361022949
ob_t_err is 0.43614354729652405
-----
bad optimization!
-----
before optimization
geo loss is 5.338813835464862e-09
r_err is 2.7118902679035273e-08
t_err is 4.865499558803776e-09
ob_loss is 0.06983692944049835
ob_r_err is 0.3744161128997803
ob_t_err is 0.06330164521932602
-----
before, dynamic flow loss is 0.41199591755867004
predicted weight is 0.11786018311977386
predicted dynamic weight is 0.15517708659172058
predicted dynamic flow loss is 0.4057950973510742
predicted flow loss is 4.3623576164245605
predicted flow delta is 0.7048938274383545
first residual should be 0.006200801115483046
dyna residual is 0.006200801115483046
dyna residual is -0.024716923013329506
dyna residual is -0.0524769127368927
dyna residual is -0.05161122605204582
dyna residual is -0.051540523767471313
dyna residual is -0.05151227489113808
dyna residual is -0.051512543112039566
dyna residual is -0.051523901522159576
-----
after optimization
geo loss is 5.338813835464862e-09
r_err is 2.7118902679035273e-08
t_err is 4.865499558803776e-09
ob_loss is 0.1465373933315277
ob_r_err is 1.9793643951416016
ob_t_err is 0.11198081076145172
-----
bad optimization!
['val_rot_error', 'val_tr_error', 'val_bad_rot', 'val_bad_tr', 'val_ob_rot_error', 'val_ob_tr_error', 'val_ob_bad_rot', 'val_ob_bad_tr', 'val_residual', 'val_low_f_error', 'val_low_1px', 'val_low_dyna_f_error', 'val_low_dyna_1px', 'val_low_f_induced_error', 'val_low_induced_1px', 'val_low_f_dyna_induced_error', 'val_low_dyna_induced_1px', 'val_abs_low_error', 'val_abs_low_dyna_error', 'val_abs_depth_low_error', 'val_geo_loss', 'val_Obgeo_loss', 'val_error_lowflow', 'val_error_lowdepth', 'val_error_induced_low', 'val_error_dylow', 'val_error_lowdynadepth']
[    20,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,     8.5719,     0.3644,     0.0909,     0.1227,     1.7041,     3.4561,     0.3607,     5.8230,     0.2334,     0.2787,     0.9503,     7.6325,     0.1674,     0.0000,     0.0000,     0.0000,     0.0000,     0.5176,     3.4556,     0.0000,     7.6325,     5.8230,     0.0000, 
-----
before optimization
geo loss is 3.6476239806404465e-09
r_err is 7.052260286855017e-08
t_err is 2.4167725598545076e-09
ob_loss is 0.0936388149857521
ob_r_err is 0.0
ob_t_err is 0.0936388149857521
-----
before, dynamic flow loss is 0.22612157464027405
predicted weight is 0.25271767377853394
predicted dynamic weight is 0.04418870806694031
predicted dynamic flow loss is 0.46804049611091614
predicted flow loss is 2.753373622894287
predicted flow delta is 0.026432642713189125
first residual should be -0.2419189214706421
dyna residual is -0.2419189214706421
dyna residual is 0.2730345129966736
dyna residual is -0.11024671047925949
dyna residual is 0.5353483557701111
dyna residual is 0.07861889898777008
dyna residual is -0.2846425771713257
dyna residual is 0.33720049262046814
dyna residual is -0.09284206479787827
-----
after optimization
geo loss is 3.6476239806404465e-09
r_err is 7.052260286855017e-08
t_err is 2.4167725598545076e-09
ob_loss is 1.1001745462417603
ob_r_err is 20.87908172607422
ob_t_err is 0.7291211485862732
-----
bad optimization!
-----
before optimization
geo loss is 6.495026738662091e-09
r_err is 2.937879060027626e-07
t_err is 1.3674604781854782e-09
ob_loss is 0.48875752091407776
ob_r_err is 5.297878265380859
ob_t_err is 0.39572885632514954
-----
before, dynamic flow loss is 10.615681648254395
predicted weight is 0.07954657077789307
predicted dynamic weight is 0.125320166349411
predicted dynamic flow loss is 10.873117446899414
predicted flow loss is 5.076318740844727
predicted flow delta is 0.26929304003715515
first residual should be -0.2574349045753479
dyna residual is -0.2574349045753479
dyna residual is -0.14663340151309967
dyna residual is 0.0052595483139157295
dyna residual is -0.004324872046709061
dyna residual is -0.004552580416202545
dyna residual is -0.004573828540742397
dyna residual is -0.004559188149869442
dyna residual is -0.004586606286466122
-----
after optimization
geo loss is 6.495026738662091e-09
r_err is 2.937879060027626e-07
t_err is 1.3674604781854782e-09
ob_loss is 0.486369788646698
ob_r_err is 11.647096633911133
ob_t_err is 0.28135946393013
-----
bad optimization!
-----
before optimization
geo loss is 7.652987688011592e-10
r_err is 8.842050647217548e-09
t_err is 6.109758809991206e-10
ob_loss is 0.046614766120910645
ob_r_err is 0.7301268577575684
ob_t_err is 0.03387102484703064
-----
before, dynamic flow loss is 0.23356445133686066
predicted weight is 0.3786173164844513
predicted dynamic weight is 0.27578526735305786
predicted dynamic flow loss is 0.29888200759887695
predicted flow loss is 0.9232679605484009
predicted flow delta is 0.004967804066836834
first residual should be -0.06531758606433868
dyna residual is -0.06531758606433868
dyna residual is -0.032864559441804886
dyna residual is -0.03079608827829361
dyna residual is -0.03542540967464447
dyna residual is -0.029652895405888557
dyna residual is -0.03392525017261505
dyna residual is -0.03064131736755371
dyna residual is -0.03291931003332138
-----
after optimization
geo loss is 7.652987688011592e-10
r_err is 8.842050647217548e-09
t_err is 6.109758809991206e-10
ob_loss is 0.12980198860168457
ob_r_err is 2.418210506439209
ob_t_err is 0.08757288008928299
-----
bad optimization!
-----
before optimization
geo loss is 3.705647788621036e-09
r_err is 1.2698890827778087e-07
t_err is 1.4892730382243258e-09
ob_loss is 0.29933980107307434
ob_r_err is 7.773504257202148
ob_t_err is 0.163457453250885
-----
before, dynamic flow loss is 0.3252771496772766
predicted weight is 0.1545870155096054
predicted dynamic weight is 0.08910904824733734
predicted dynamic flow loss is 0.39318427443504333
predicted flow loss is 3.436518669128418
predicted flow delta is -0.22346682846546173
first residual should be -0.06790716201066971
dyna residual is -0.06790716201066971
dyna residual is -0.00831376388669014
dyna residual is -0.021437902003526688
dyna residual is -0.011856871657073498
dyna residual is -0.016202108934521675
dyna residual is -0.01326700858771801
dyna residual is -0.015037508681416512
dyna residual is -0.01383865624666214
-----
after optimization
geo loss is 3.705647788621036e-09
r_err is 1.2698890827778087e-07
t_err is 1.4892730382243258e-09
ob_loss is 0.6594250202178955
ob_r_err is 7.919483661651611
ob_t_err is 0.5204484462738037
-----
bad optimization!
-----
before optimization
geo loss is 3.345515864339177e-09
r_err is 8.255983630078845e-08
t_err is 1.9045747201573704e-09
ob_loss is 0.21615688502788544
ob_r_err is 0.3432464599609375
ob_t_err is 0.21016506850719452
-----
before, dynamic flow loss is 2.4012818336486816
predicted weight is 0.11869747191667557
predicted dynamic weight is 0.19527527689933777
predicted dynamic flow loss is 3.743537425994873
predicted flow loss is 4.710055828094482
predicted flow delta is -0.013372238725423813
first residual should be -1.3422554731369019
dyna residual is -1.3422554731369019
dyna residual is -10.354924201965332
dyna residual is -4.251595973968506
dyna residual is -1.3353447914123535
dyna residual is -0.0760810449719429
dyna residual is 0.13530045747756958
dyna residual is -0.20219950377941132
dyna residual is 0.08944271504878998
-----
after optimization
geo loss is 3.345515864339177e-09
r_err is 8.255983630078845e-08
t_err is 1.9045747201573704e-09
ob_loss is 0.47675666213035583
ob_r_err is 7.3632354736328125
ob_t_err is 0.3479000926017761
-----
bad optimization!
-----
before optimization
geo loss is 1.4809795612080734e-09
r_err is 7.799335577374222e-08
t_err is 1.1973860791769653e-10
ob_loss is 0.05337972939014435
ob_r_err is 1.4086607694625854
ob_t_err is 0.02879270724952221
-----
before, dynamic flow loss is 0.19859182834625244
predicted weight is 0.028297537937760353
predicted dynamic weight is 0.07185454666614532
predicted dynamic flow loss is -0.290815532207489
predicted flow loss is 6.395768165588379
predicted flow delta is -1.0526866912841797
first residual should be 0.48940736055374146
dyna residual is 0.48940736055374146
dyna residual is 0.5463587045669556
dyna residual is 0.42639103531837463
dyna residual is 0.4052536189556122
dyna residual is 0.3725382387638092
dyna residual is 0.3699929118156433
dyna residual is 0.3650711178779602
dyna residual is 0.3648895025253296
-----
after optimization
geo loss is 1.4809795612080734e-09
r_err is 7.799335577374222e-08
t_err is 1.1973860791769653e-10
ob_loss is 0.2322964072227478
ob_r_err is 7.578334808349609
ob_t_err is 0.09989149123430252
-----
bad optimization!
-----
before optimization
geo loss is 1.2100865864894672e-09
r_err is 2.083816674769423e-08
t_err is 8.463919010104348e-10
ob_loss is 0.010103419423103333
ob_r_err is 6.528162884933408e-06
ob_t_err is 0.01010330580174923
-----
before, dynamic flow loss is 0.03296685591340065
predicted weight is 0.2891480028629303
predicted dynamic weight is 0.42776745557785034
predicted dynamic flow loss is -0.13354086875915527
predicted flow loss is 2.4524080753326416
predicted flow delta is -0.03667990118265152
first residual should be 0.16650773584842682
dyna residual is 0.16650773584842682
dyna residual is 0.1137382760643959
dyna residual is 0.1203230693936348
dyna residual is 0.1178797259926796
dyna residual is 0.11892528086900711
dyna residual is 0.1184220090508461
dyna residual is 0.11866096407175064
dyna residual is 0.11854220181703568
-----
after optimization
geo loss is 1.2100865864894672e-09
r_err is 2.083816674769423e-08
t_err is 8.463919010104348e-10
ob_loss is 0.06418906152248383
ob_r_err is 2.033543586730957
ob_t_err is 0.028693487867712975
-----
bad optimization!
-----
before optimization
geo loss is 1.3894980277484592e-08
r_err is 4.244185092261432e-08
t_err is 1.315423059367049e-08
ob_loss is 0.444444477558136
ob_r_err is 10.112264633178711
ob_t_err is 0.2673119604587555
-----
before, dynamic flow loss is 31.871347427368164
predicted weight is 0.2194983810186386
predicted dynamic weight is 0.0008019377710297704
predicted dynamic flow loss is 34.21043395996094
predicted flow loss is 4.01787805557251
predicted flow delta is -0.3828240931034088
first residual should be -2.3390843868255615
dyna residual is -2.3390843868255615
dyna residual is -1.5371228456497192
dyna residual is -0.3551791310310364
dyna residual is -0.4324691891670227
dyna residual is -0.5822433829307556
dyna residual is -0.6935309767723083
dyna residual is -0.5373488664627075
dyna residual is 0.12036535143852234
-----
after optimization
geo loss is 1.3894980277484592e-08
r_err is 4.244185092261432e-08
t_err is 1.315423059367049e-08
ob_loss is 4.816751480102539
ob_r_err is 59.41379928588867
ob_t_err is 3.3016843795776367
-----
bad optimization!
-----
before optimization
geo loss is 3.581304142130648e-09
r_err is 1.3754259953202563e-07
t_err is 1.1807330668744953e-09
ob_loss is 0.322248637676239
ob_r_err is 8.117907524108887
ob_t_err is 0.18032117187976837
-----
before, dynamic flow loss is 0.3556310832500458
predicted weight is 0.14687775075435638
predicted dynamic weight is 0.06411584466695786
predicted dynamic flow loss is 0.46258002519607544
predicted flow loss is 3.456392288208008
predicted flow delta is -0.2222387194633484
first residual should be -0.10694895684719086
dyna residual is -0.10694895684719086
dyna residual is -0.040244344621896744
dyna residual is -0.0413341298699379
dyna residual is -0.04074156656861305
dyna residual is -0.039296820759773254
dyna residual is -0.03960808739066124
dyna residual is -0.039301127195358276
dyna residual is -0.03940383344888687
-----
after optimization
geo loss is 3.581304142130648e-09
r_err is 1.3754259953202563e-07
t_err is 1.1807330668744953e-09
ob_loss is 0.4255862534046173
ob_r_err is 6.952391624450684
ob_t_err is 0.3039543032646179
-----
bad optimization!
-----
before optimization
geo loss is 3.1212921136614113e-09
r_err is 1.0892074442381272e-07
t_err is 1.2202664434468602e-09
ob_loss is 0.0886010006070137
ob_r_err is 1.6566554307937622
ob_t_err is 0.05968337878584862
-----
before, dynamic flow loss is 0.3076587915420532
predicted weight is 0.042016658931970596
predicted dynamic weight is 0.1142733246088028
predicted dynamic flow loss is 0.18091389536857605
predicted flow loss is 6.175042629241943
predicted flow delta is -0.4216495752334595
first residual should be 0.12674491107463837
dyna residual is 0.12674491107463837
dyna residual is 0.08498212695121765
dyna residual is 0.0889560654759407
dyna residual is 0.09059349447488785
dyna residual is 0.09065189957618713
dyna residual is 0.0906439945101738
dyna residual is 0.09062831848859787
dyna residual is 0.0906374529004097
-----
after optimization
geo loss is 3.1212921136614113e-09
r_err is 1.0892074442381272e-07
t_err is 1.2202664434468602e-09
ob_loss is 0.21529631316661835
ob_r_err is 6.190568447113037
ob_t_err is 0.10717019438743591
-----
bad optimization!
-----
before optimization
geo loss is 4.14078904498183e-09
r_err is 6.705757016334246e-08
t_err is 2.9704136927932723e-09
ob_loss is 0.029528087005019188
ob_r_err is 0.0
ob_t_err is 0.029528087005019188
-----
before, dynamic flow loss is 0.5094299912452698
predicted weight is 0.09564907848834991
predicted dynamic weight is 0.1304180771112442
predicted dynamic flow loss is 0.5000079870223999
predicted flow loss is 4.67237663269043
predicted flow delta is 0.06882016360759735
first residual should be 0.009422005154192448
dyna residual is 0.009422005154192448
dyna residual is -0.4551253914833069
dyna residual is -0.025506269186735153
dyna residual is -0.05520709604024887
dyna residual is 0.02274327725172043
dyna residual is 0.0022934882435947657
dyna residual is 0.030923184007406235
dyna residual is 0.017850691452622414
-----
after optimization
geo loss is 4.14078904498183e-09
r_err is 6.705757016334246e-08
t_err is 2.9704136927932723e-09
ob_loss is 0.15821392834186554
ob_r_err is 3.1855146884918213
ob_t_err is 0.1025959700345993
-----
bad optimization!
-----
before optimization
geo loss is 2.3314365993343245e-09
r_err is 4.5826148209471285e-08
t_err is 1.5316194978964859e-09
ob_loss is 0.020631004124879837
ob_r_err is 0.0
ob_t_err is 0.020631004124879837
-----
before, dynamic flow loss is 0.302376389503479
predicted weight is 0.19033865630626678
predicted dynamic weight is 0.2647017240524292
predicted dynamic flow loss is 0.2326328307390213
predicted flow loss is 3.9788334369659424
predicted flow delta is 0.04137455299496651
first residual should be 0.06974353641271591
dyna residual is 0.06974353641271591
dyna residual is -0.17347779870033264
dyna residual is 0.04796193912625313
dyna residual is 0.038165345788002014
dyna residual is 0.08249469846487045
dyna residual is 0.07604797184467316
dyna residual is 0.08668026328086853
dyna residual is 0.0844610184431076
-----
after optimization
geo loss is 2.3314365993343245e-09
r_err is 4.5826148209471285e-08
t_err is 1.5316194978964859e-09
ob_loss is 0.13788551092147827
ob_r_err is 2.895174741744995
ob_t_err is 0.08734353631734848
-----
bad optimization!
-----
before optimization
geo loss is 1.6301291427822662e-09
r_err is 6.262763463382726e-08
t_err is 5.370706657181756e-10
ob_loss is 0.07220352441072464
ob_r_err is 0.93073970079422
ob_t_err is 0.05595742166042328
-----
before, dynamic flow loss is 0.38889434933662415
predicted weight is 0.43597614765167236
predicted dynamic weight is 0.32953941822052
predicted dynamic flow loss is 0.46853020787239075
predicted flow loss is 1.2123990058898926
predicted flow delta is 0.07701689004898071
first residual should be -0.07963583618402481
dyna residual is -0.07963583618402481
dyna residual is 0.09563730657100677
dyna residual is 0.022205611690878868
dyna residual is 0.04854440316557884
dyna residual is 0.04717990756034851
dyna residual is 0.0500454381108284
dyna residual is 0.05009223520755768
dyna residual is 0.05038881674408913
-----
after optimization
geo loss is 1.6301291427822662e-09
r_err is 6.262763463382726e-08
t_err is 5.370706657181756e-10
ob_loss is 0.40050244331359863
ob_r_err is 8.214765548706055
ob_t_err is 0.2559136152267456
-----
bad optimization!
-----
before optimization
geo loss is 1.8596202355780633e-09
r_err is 7.362795173548875e-08
t_err is 5.745700026871248e-10
ob_loss is 0.07571394741535187
ob_r_err is 1.6777687072753906
ob_t_err is 0.04642866179347038
-----
before, dynamic flow loss is 0.2925099730491638
predicted weight is 0.1721063107252121
predicted dynamic weight is 0.14020009338855743
predicted dynamic flow loss is 0.25333136320114136
predicted flow loss is 2.316399097442627
predicted flow delta is 0.14401334524154663
first residual should be 0.03917858377099037
dyna residual is 0.03917858377099037
dyna residual is 0.09644388407468796
dyna residual is 0.037484779953956604
dyna residual is 0.07710891216993332
dyna residual is 0.03908717259764671
dyna residual is 0.05442912504076958
dyna residual is 0.04133222997188568
dyna residual is 0.04458189755678177
-----
after optimization
geo loss is 1.8596202355780633e-09
r_err is 7.362795173548875e-08
t_err is 5.745700026871248e-10
ob_loss is 0.4182112216949463
ob_r_err is 10.417115211486816
ob_t_err is 0.2350664883852005
-----
bad optimization!
-----
before optimization
geo loss is 1.38246436520717e-09
r_err is 5.0544052498935343e-08
t_err is 5.003042424789328e-10
ob_loss is 0.07042735815048218
ob_r_err is 1.468645453453064
ob_t_err is 0.044792599976062775
-----
before, dynamic flow loss is 0.356355220079422
predicted weight is 0.24245859682559967
predicted dynamic weight is 0.15675131976604462
predicted dynamic flow loss is 0.4145030081272125
predicted flow loss is 1.7679054737091064
predicted flow delta is 0.09398554265499115
first residual should be -0.058147791773080826
dyna residual is -0.058147791773080826
dyna residual is 0.05041541904211044
dyna residual is -0.01758008822798729
dyna residual is 0.02911331132054329
dyna residual is -0.0021207863464951515
dyna residual is 0.025113070383667946
dyna residual is 0.010969617404043674
dyna residual is 0.021736949682235718
-----
after optimization
geo loss is 1.38246436520717e-09
r_err is 5.0544052498935343e-08
t_err is 5.003042424789328e-10
ob_loss is 0.23156653344631195
ob_r_err is 5.850856781005859
ob_t_err is 0.1293359100818634
-----
bad optimization!
-----
before optimization
geo loss is 3.250079538830164e-09
r_err is 1.2281073225040018e-07
t_err is 1.1066279004268154e-09
ob_loss is 0.11223890632390976
ob_r_err is 1.484580397605896
ob_t_err is 0.08632326126098633
-----
before, dynamic flow loss is -0.6768401265144348
predicted weight is 0.04248529672622681
predicted dynamic weight is 0.13644355535507202
predicted dynamic flow loss is -0.37065616250038147
predicted flow loss is 6.363389015197754
predicted flow delta is 0.023868001997470856
first residual should be -0.3061838746070862
dyna residual is -0.3061838746070862
dyna residual is 2.411285638809204
dyna residual is 0.8066073656082153
dyna residual is 0.35237178206443787
dyna residual is 0.19077229499816895
dyna residual is 0.190158411860466
dyna residual is 0.17745175957679749
dyna residual is 0.18352581560611725
-----
after optimization
geo loss is 3.250079538830164e-09
r_err is 1.2281073225040018e-07
t_err is 1.1066279004268154e-09
ob_loss is 0.47266849875450134
ob_r_err is 11.380635261535645
ob_t_err is 0.2734547257423401
-----
bad optimization!
-----
before optimization
geo loss is 5.50506662477801e-09
r_err is 1.3639316875924123e-07
t_err is 3.124556613443019e-09
ob_loss is 0.15375934541225433
ob_r_err is 0.35118475556373596
ob_t_err is 0.14762945473194122
-----
before, dynamic flow loss is 0.00045561211300082505
predicted weight is 0.15557783842086792
predicted dynamic weight is 0.11281394958496094
predicted dynamic flow loss is 0.4072117209434509
predicted flow loss is 3.8918697834014893
predicted flow delta is -0.6122742295265198
first residual should be -0.40675613284111023
dyna residual is -0.40675613284111023
dyna residual is -0.035736773163080215
dyna residual is 0.04805006459355354
dyna residual is 0.05324072018265724
dyna residual is 0.05359344929456711
dyna residual is 0.05371870473027229
dyna residual is 0.053658127784729004
dyna residual is 0.053718894720077515
-----
after optimization
geo loss is 5.50506662477801e-09
r_err is 1.3639316875924123e-07
t_err is 3.124556613443019e-09
ob_loss is 0.4773752689361572
ob_r_err is 5.835378646850586
ob_t_err is 0.37524691224098206
-----
bad optimization!
-----
before optimization
geo loss is 3.298404660512233e-09
r_err is 1.7391043627412728e-07
t_err is 2.6309510126054647e-10
ob_loss is 0.2257404923439026
ob_r_err is 6.534665584564209
ob_t_err is 0.11156903952360153
-----
before, dynamic flow loss is 0.13472627103328705
predicted weight is 0.1446240395307541
predicted dynamic weight is 0.10864348709583282
predicted dynamic flow loss is 0.2246929109096527
predicted flow loss is 4.072805881500244
predicted flow delta is 0.01553831622004509
first residual should be -0.08996669203042984
dyna residual is -0.08996669203042984
dyna residual is -0.042288102209568024
dyna residual is -0.03696112334728241
dyna residual is -0.0457129068672657
dyna residual is -0.03349396958947182
dyna residual is -0.0349825844168663
dyna residual is -0.03177105635404587
dyna residual is -0.030472589656710625
-----
after optimization
geo loss is 3.298404660512233e-09
r_err is 1.7391043627412728e-07
t_err is 2.6309510126054647e-10
ob_loss is 0.37183529138565063
ob_r_err is 4.705982208251953
ob_t_err is 0.2894844710826874
-----
bad optimization!
-----
before optimization
geo loss is 3.9438341481456973e-10
r_err is 1.4634684575298706e-08
t_err is 1.389599685319709e-10
ob_loss is 0.011606915853917599
ob_r_err is 0.14449821412563324
ob_t_err is 0.009084940887987614
-----
before, dynamic flow loss is 0.015843696892261505
predicted weight is 0.4827505052089691
predicted dynamic weight is 0.5475084781646729
predicted dynamic flow loss is 0.047440603375434875
predicted flow loss is 0.31118109822273254
predicted flow delta is 0.002621058840304613
first residual should be -0.03159691393375397
dyna residual is -0.03159691393375397
dyna residual is -0.026166722178459167
dyna residual is -0.023629065603017807
dyna residual is -0.026230141520500183
dyna residual is -0.023944705724716187
dyna residual is -0.025348901748657227
dyna residual is -0.024269836023449898
dyna residual is -0.024866556748747826
-----
after optimization
geo loss is 3.9438341481456973e-10
r_err is 1.4634684575298706e-08
t_err is 1.389599685319709e-10
ob_loss is 0.05596704035997391
ob_r_err is 1.1356382369995117
ob_t_err is 0.036144744604825974
-----
bad optimization!
-----
before optimization
geo loss is 5.579066097993746e-09
r_err is 2.5576905926527616e-08
t_err is 5.132664959717204e-09
ob_loss is 0.3922399878501892
ob_r_err is 8.933659553527832
ob_t_err is 0.2358952909708023
-----
before, dynamic flow loss is 16.676109313964844
predicted weight is 0.252179354429245
predicted dynamic weight is 0.00566014414653182
predicted dynamic flow loss is 19.626245498657227
predicted flow loss is 3.6129961013793945
predicted flow delta is -0.2649758756160736
first residual should be -2.9501335620880127
dyna residual is -2.9501335620880127
dyna residual is -2.608936071395874
dyna residual is -3.5423827171325684
dyna residual is -0.23125211894512177
dyna residual is -0.013431243598461151
dyna residual is 1.0669827461242676
dyna residual is -0.390487402677536
dyna residual is 0.5145760774612427
-----
after optimization
geo loss is 5.579066097993746e-09
r_err is 2.5576905926527616e-08
t_err is 5.132664959717204e-09
ob_loss is 3.851210355758667
ob_r_err is 35.179725646972656
ob_t_err is 3.1489362716674805
-----
bad optimization!
[    40,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,    11.0598,     0.5371,     0.0955,     0.0955,     2.0765,     3.5799,     0.3451,    10.7023,     0.1518,     0.4400,     0.9593,    16.6865,     0.1280,     0.0000,     0.0000,     0.0000,     0.0000,     0.7591,     3.5799,     0.0000,    16.6865,    10.7023,     0.0000, 
-----
before optimization
geo loss is 2.4608770576861616e-09
r_err is 1.0956208740253714e-07
t_err is 5.486579524038859e-10
ob_loss is 0.29787421226501465
ob_r_err is 7.9771881103515625
ob_t_err is 0.1584368348121643
-----
before, dynamic flow loss is 0.33357512950897217
predicted weight is 0.15043684840202332
predicted dynamic weight is 0.08223883807659149
predicted dynamic flow loss is 0.42428964376449585
predicted flow loss is 3.5502326488494873
predicted flow delta is -0.21359297633171082
first residual should be -0.09071455150842667
dyna residual is -0.09071455150842667
dyna residual is 0.003331058891490102
dyna residual is -0.025358863174915314
dyna residual is -0.028651155531406403
dyna residual is -0.03041895665228367
dyna residual is -0.030269872397184372
dyna residual is -0.030407389625906944
dyna residual is -0.030386244878172874
-----
after optimization
geo loss is 2.4608770576861616e-09
r_err is 1.0956208740253714e-07
t_err is 5.486579524038859e-10
ob_loss is 0.6424368619918823
ob_r_err is 8.612998962402344
ob_t_err is 0.4912621080875397
-----
bad optimization!
-----
before optimization
geo loss is 1.31176536299904e-09
r_err is 4.092476757477925e-08
t_err is 5.974933880992239e-10
ob_loss is 0.05495097115635872
ob_r_err is 0.0
ob_t_err is 0.05495097115635872
-----
before, dynamic flow loss is 0.11543694138526917
predicted weight is 0.30921658873558044
predicted dynamic weight is 0.11548261344432831
predicted dynamic flow loss is 0.1559048295021057
predicted flow loss is 1.9069159030914307
predicted flow delta is -0.01275206170976162
first residual should be -0.04046788066625595
dyna residual is -0.04046788066625595
dyna residual is -0.2085145264863968
dyna residual is 0.2632729411125183
dyna residual is -0.036845557391643524
dyna residual is -0.008167965337634087
dyna residual is -0.015678072348237038
dyna residual is -0.018089160323143005
dyna residual is -0.01931593380868435
-----
after optimization
geo loss is 1.31176536299904e-09
r_err is 4.092476757477925e-08
t_err is 5.974933880992239e-10
ob_loss is 1.091304898262024
ob_r_err is 21.214956283569336
ob_t_err is 0.7087987065315247
-----
bad optimization!
-----
before optimization
geo loss is 3.3967206825025187e-09
r_err is 1.0686248685942701e-07
t_err is 1.5316184986957637e-09
ob_loss is 0.19247406721115112
ob_r_err is 0.31940150260925293
ob_t_err is 0.18689890205860138
-----
before, dynamic flow loss is 1.3117974996566772
predicted weight is 0.11981075257062912
predicted dynamic weight is 0.17918722331523895
predicted dynamic flow loss is 2.1078522205352783
predicted flow loss is 5.115963935852051
predicted flow delta is 0.15947790443897247
first residual should be -0.7960547208786011
dyna residual is -0.7960547208786011
dyna residual is 0.9801979064941406
dyna residual is 0.21969152987003326
dyna residual is 0.0675918310880661
dyna residual is -0.011509758420288563
dyna residual is 0.06365538388490677
dyna residual is 0.060165658593177795
dyna residual is 0.06867765635251999
-----
after optimization
geo loss is 3.3967206825025187e-09
r_err is 1.0686248685942701e-07
t_err is 1.5316184986957637e-09
ob_loss is 0.6230992674827576
ob_r_err is 9.937429428100586
ob_t_err is 0.4487758278846741
-----
bad optimization!
-----
before optimization
geo loss is 2.467539728101542e-09
r_err is 1.161165030794109e-07
t_err is 4.409243248293393e-10
ob_loss is 0.38569068908691406
ob_r_err is 10.310866355895996
ob_t_err is 0.20523899793624878
-----
before, dynamic flow loss is 1.8247063159942627
predicted weight is 0.16260851919651031
predicted dynamic weight is 0.1886233389377594
predicted dynamic flow loss is 1.939206838607788
predicted flow loss is 3.7828917503356934
predicted flow delta is -0.11588907241821289
first residual should be -0.11450061947107315
dyna residual is -0.11450061947107315
dyna residual is -0.016385521739721298
dyna residual is -0.020802482962608337
dyna residual is -0.020626142621040344
dyna residual is -0.02062954381108284
dyna residual is -0.020620256662368774
dyna residual is -0.020622283220291138
dyna residual is -0.020620450377464294
-----
after optimization
geo loss is 2.467539728101542e-09
r_err is 1.161165030794109e-07
t_err is 4.409243248293393e-10
ob_loss is 0.2900940477848053
ob_r_err is 10.374000549316406
ob_t_err is 0.10879899561405182
-----
bad optimization!
-----
before optimization
geo loss is 2.8836935062059865e-09
r_err is 7.100738486087721e-08
t_err is 1.6443808537047744e-09
ob_loss is 0.06888620555400848
ob_r_err is 1.7655595541000366
ob_t_err is 0.038068950176239014
-----
before, dynamic flow loss is -0.043605972081422806
predicted weight is 0.12065165489912033
predicted dynamic weight is 0.20319798588752747
predicted dynamic flow loss is -0.16107894480228424
predicted flow loss is 2.683208465576172
predicted flow delta is 0.16886809468269348
first residual should be 0.11747297644615173
dyna residual is 0.11747297644615173
dyna residual is 0.036206405609846115
dyna residual is 0.09447018802165985
dyna residual is 0.010084036737680435
dyna residual is 0.04018118232488632
dyna residual is 0.02587546966969967
dyna residual is 0.02894163317978382
dyna residual is 0.027482450008392334
-----
after optimization
geo loss is 2.8836935062059865e-09
r_err is 7.100738486087721e-08
t_err is 1.6443808537047744e-09
ob_loss is 0.503424882888794
ob_r_err is 11.857515335083008
ob_t_err is 0.2941478490829468
-----
bad optimization!
-----
before optimization
geo loss is 3.102890833162064e-09
r_err is 7.67239214383153e-08
t_err is 1.763805768106863e-09
ob_loss is 0.19912073016166687
ob_r_err is 0.31828832626342773
ob_t_err is 0.1935649812221527
-----
before, dynamic flow loss is 1.5543781518936157
predicted weight is 0.14315848052501678
predicted dynamic weight is 0.16492418944835663
predicted dynamic flow loss is 1.7556545734405518
predicted flow loss is 4.625324249267578
predicted flow delta is 0.1977090686559677
first residual should be -0.2012765109539032
dyna residual is -0.2012765109539032
dyna residual is -0.4958704113960266
dyna residual is -0.15623512864112854
dyna residual is -0.09149811416864395
dyna residual is -0.07594182342290878
dyna residual is -0.07965514808893204
dyna residual is -0.07660423219203949
dyna residual is -0.07787521183490753
-----
after optimization
geo loss is 3.102890833162064e-09
r_err is 7.67239214383153e-08
t_err is 1.763805768106863e-09
ob_loss is 0.5231460332870483
ob_r_err is 9.270919799804688
ob_t_err is 0.3609129786491394
-----
bad optimization!
-----
before optimization
geo loss is 2.526895137577867e-09
r_err is 5.372545075488233e-08
t_err is 1.589208986629842e-09
ob_loss is 0.18193058669567108
ob_r_err is 0.3034587800502777
ob_t_err is 0.17663373053073883
-----
before, dynamic flow loss is 1.2957768440246582
predicted weight is 0.1555749475955963
predicted dynamic weight is 0.23360435664653778
predicted dynamic flow loss is 1.3597854375839233
predicted flow loss is 4.002935409545898
predicted flow delta is 0.053745709359645844
first residual should be -0.064008429646492
dyna residual is -0.064008429646492
dyna residual is 0.032946500927209854
dyna residual is 0.1456839144229889
dyna residual is -0.029313303530216217
dyna residual is -0.0516897477209568
dyna residual is -0.03695675730705261
dyna residual is -0.03991125524044037
dyna residual is -0.03896355256438255
-----
after optimization
geo loss is 2.526895137577867e-09
r_err is 5.372545075488233e-08
t_err is 1.589208986629842e-09
ob_loss is 0.5110429525375366
ob_r_err is 11.092315673828125
ob_t_err is 0.31674429774284363
-----
bad optimization!
-----
before optimization
geo loss is 3.779529578196161e-09
r_err is 1.049692315291395e-07
t_err is 1.9474708512490224e-09
ob_loss is 0.10312391817569733
ob_r_err is 0.0
ob_t_err is 0.10312391817569733
-----
before, dynamic flow loss is 0.15566512942314148
predicted weight is 0.24845817685127258
predicted dynamic weight is 0.11537694931030273
predicted dynamic flow loss is 0.005240419879555702
predicted flow loss is 3.2162578105926514
predicted flow delta is 0.2585986256599426
first residual should be 0.15042468905448914
dyna residual is 0.15042468905448914
dyna residual is 0.004235247150063515
dyna residual is -0.15118515491485596
dyna residual is -0.06571485102176666
dyna residual is -0.10607024282217026
dyna residual is -0.07146843522787094
dyna residual is -0.11372331529855728
dyna residual is -0.03959164768457413
-----
after optimization
geo loss is 3.779529578196161e-09
r_err is 1.049692315291395e-07
t_err is 1.9474708512490224e-09
ob_loss is 1.2444567680358887
ob_r_err is 24.969192504882812
ob_t_err is 0.7934699058532715
-----
bad optimization!
-----
before optimization
geo loss is 6.392245621711368e-10
r_err is 1.148287331886877e-08
t_err is 4.388106267239067e-10
ob_loss is 0.02304113283753395
ob_r_err is 0.6571022272109985
ob_t_err is 0.01157215517014265
-----
before, dynamic flow loss is -0.03850872442126274
predicted weight is 0.507280707359314
predicted dynamic weight is 0.5868009924888611
predicted dynamic flow loss is -0.01942826807498932
predicted flow loss is 1.2574282884597778
predicted flow delta is -0.011455744504928589
first residual should be -0.019080450758337975
dyna residual is -0.019080450758337975
dyna residual is 0.010787117294967175
dyna residual is 0.014501876197755337
dyna residual is 0.015905117616057396
dyna residual is 0.01672273501753807
dyna residual is 0.01706300675868988
dyna residual is 0.017228033393621445
dyna residual is 0.017312409356236458
-----
after optimization
geo loss is 6.392245621711368e-10
r_err is 1.148287331886877e-08
t_err is 4.388106267239067e-10
ob_loss is 0.03668729215860367
ob_r_err is 1.4621152877807617
ob_t_err is 0.011165660806000233
-----
bad optimization!
-----
before optimization
geo loss is 1.539219418589255e-09
r_err is 7.350157460450646e-08
t_err is 2.5637483802576355e-10
ob_loss is 0.08699774742126465
ob_r_err is 3.092799186706543
ob_t_err is 0.03299979865550995
-----
before, dynamic flow loss is 0.053768057376146317
predicted weight is 0.17072652280330658
predicted dynamic weight is 0.5318542122840881
predicted dynamic flow loss is 0.06958598643541336
predicted flow loss is 3.235140800476074
predicted flow delta is -0.1244213879108429
first residual should be -0.01581791415810585
dyna residual is -0.01581791415810585
dyna residual is 0.0002206856879638508
dyna residual is 0.06699370592832565
dyna residual is -0.0681609958410263
dyna residual is 0.07689817994832993
dyna residual is -0.02547207474708557
dyna residual is 0.027465850114822388
dyna residual is 0.0038099419325590134
-----
after optimization
geo loss is 1.539219418589255e-09
r_err is 7.350157460450646e-08
t_err is 2.5637483802576355e-10
ob_loss is 0.48832833766937256
ob_r_err is 11.936723709106445
ob_t_err is 0.27910420298576355
-----
bad optimization!
-----
before optimization
geo loss is 2.367151585858096e-09
r_err is 6.819043107952893e-08
t_err is 1.1770040497793843e-09
ob_loss is 0.13244108855724335
ob_r_err is 2.637742280960083
ob_t_err is 0.0863904356956482
-----
before, dynamic flow loss is 0.11742818355560303
predicted weight is 0.5718715190887451
predicted dynamic weight is 0.11137844622135162
predicted dynamic flow loss is 0.21275396645069122
predicted flow loss is 1.3743735551834106
predicted flow delta is 0.023825526237487793
first residual should be -0.09532580524682999
dyna residual is -0.09532580524682999
dyna residual is -0.02602691762149334
dyna residual is 0.009781365282833576
dyna residual is -0.011386014521121979
dyna residual is 0.00953605119138956
dyna residual is -0.0016175756463781
dyna residual is 0.009911222383379936
dyna residual is 0.0013811069075018167
-----
after optimization
geo loss is 2.367151585858096e-09
r_err is 6.819043107952893e-08
t_err is 1.1770040497793843e-09
ob_loss is 0.35632073879241943
ob_r_err is 4.789270877838135
ob_t_err is 0.272563636302948
-----
bad optimization!
-----
before optimization
geo loss is 1.381313396997541e-09
r_err is 5.29378070268649e-08
t_err is 4.5737436060733216e-10
ob_loss is 0.088669054210186
ob_r_err is 0.9800949096679688
ob_t_err is 0.0715615525841713
-----
before, dynamic flow loss is 0.06088199093937874
predicted weight is 0.2768189013004303
predicted dynamic weight is 0.4627752900123596
predicted dynamic flow loss is 0.11721189320087433
predicted flow loss is 2.111607313156128
predicted flow delta is -0.08955076336860657
first residual should be -0.056329917162656784
dyna residual is -0.056329917162656784
dyna residual is -0.03587427735328674
dyna residual is -0.036067280918359756
dyna residual is -0.03634969890117645
dyna residual is -0.036329519003629684
dyna residual is -0.036335792392492294
dyna residual is -0.03633605316281319
dyna residual is -0.03633667156100273
-----
after optimization
geo loss is 1.381313396997541e-09
r_err is 5.29378070268649e-08
t_err is 4.5737436060733216e-10
ob_loss is 0.165683776140213
ob_r_err is 5.0713653564453125
ob_t_err is 0.07712860405445099
-----
bad optimization!
-----
before optimization
geo loss is 3.2612028633138834e-09
r_err is 1.0553505802590735e-07
t_err is 1.4192688135850062e-09
ob_loss is 0.06965118646621704
ob_r_err is 1.993505835533142
ob_t_err is 0.03485433757305145
-----
before, dynamic flow loss is -0.11918487399816513
predicted weight is 0.06831182539463043
predicted dynamic weight is 0.2370709925889969
predicted dynamic flow loss is -0.12567086517810822
predicted flow loss is 5.864228248596191
predicted flow delta is -0.09779553860425949
first residual should be 0.006486011669039726
dyna residual is 0.006486011669039726
dyna residual is 0.02617371641099453
dyna residual is 0.009416799992322922
dyna residual is 0.06774481385946274
dyna residual is 0.04148711636662483
dyna residual is 0.0861065536737442
dyna residual is 0.058558978140354156
dyna residual is 0.07348344475030899
-----
after optimization
geo loss is 3.2612028633138834e-09
r_err is 1.0553505802590735e-07
t_err is 1.4192688135850062e-09
ob_loss is 0.37376636266708374
ob_r_err is 10.723701477050781
ob_t_err is 0.18623340129852295
-----
bad optimization!
-----
before optimization
geo loss is 3.982127960711068e-09
r_err is 1.3813883015245665e-07
t_err is 1.571150543000499e-09
ob_loss is 0.09282205998897552
ob_r_err is 0.00031815169495530427
ob_t_err is 0.09281650930643082
-----
before, dynamic flow loss is 0.23814041912555695
predicted weight is 0.12932954728603363
predicted dynamic weight is 0.044507719576358795
predicted dynamic flow loss is 0.5482301115989685
predicted flow loss is 4.977749824523926
predicted flow delta is 0.055213965475559235
first residual should be -0.310089647769928
dyna residual is -0.310089647769928
dyna residual is 4.218332767486572
dyna residual is 0.35429808497428894
dyna residual is 0.03841790184378624
dyna residual is 0.21749761700630188
dyna residual is 0.16820143163204193
dyna residual is 0.14737842977046967
dyna residual is 0.15259967744350433
-----
after optimization
geo loss is 3.982127960711068e-09
r_err is 1.3813883015245665e-07
t_err is 1.571150543000499e-09
ob_loss is 1.7174452543258667
ob_r_err is 34.01283645629883
ob_t_err is 1.0861423015594482
-----
bad optimization!
-----
before optimization
geo loss is 3.74351838416942e-09
r_err is 7.545538238673544e-08
t_err is 2.4265733866712935e-09
ob_loss is 0.03210704028606415
ob_r_err is 5.304908881953452e-06
ob_t_err is 0.032106947153806686
-----
before, dynamic flow loss is -0.0199655219912529
predicted weight is 0.029687611386179924
predicted dynamic weight is 0.05496854707598686
predicted dynamic flow loss is 0.500708818435669
predicted flow loss is 5.221620559692383
predicted flow delta is 0.11169125139713287
first residual should be -0.5206742882728577
dyna residual is -0.5206742882728577
dyna residual is -0.19546881318092346
dyna residual is -0.03424321860074997
dyna residual is -0.06911112368106842
dyna residual is 0.057955775409936905
dyna residual is -0.040745820850133896
dyna residual is 0.07879334688186646
dyna residual is -0.029000503942370415
-----
after optimization
geo loss is 3.74351838416942e-09
r_err is 7.545538238673544e-08
t_err is 2.4265733866712935e-09
ob_loss is 0.3983336091041565
ob_r_err is 9.352446556091309
ob_t_err is 0.23461076617240906
-----
bad optimization!
-----
before optimization
geo loss is 3.5087317495907655e-09
r_err is 1.8157055592382676e-07
t_err is 3.3972780144608805e-10
ob_loss is 0.2631269693374634
ob_r_err is 2.3115217685699463
ob_t_err is 0.2227334827184677
-----
before, dynamic flow loss is -0.396436482667923
predicted weight is 0.1308484971523285
predicted dynamic weight is 0.190323606133461
predicted dynamic flow loss is -0.6088961362838745
predicted flow loss is 4.149546146392822
predicted flow delta is 0.15563304722309113
first residual should be 0.21245957911014557
dyna residual is 0.21245957911014557
dyna residual is 0.07086338847875595
dyna residual is 0.08238211274147034
dyna residual is 0.08793368190526962
dyna residual is 0.08905438333749771
dyna residual is 0.0881776288151741
dyna residual is 0.08830421417951584
dyna residual is 0.08808798342943192
-----
after optimization
geo loss is 3.5087317495907655e-09
r_err is 1.8157055592382676e-07
t_err is 3.3972780144608805e-10
ob_loss is 0.5654556155204773
ob_r_err is 10.849519729614258
ob_t_err is 0.3753643035888672
-----
bad optimization!
-----
before optimization
geo loss is 8.069549473077586e-09
r_err is 2.643457719386788e-08
t_err is 7.608178975715418e-09
ob_loss is 0.19298848509788513
ob_r_err is 4.884185314178467
ob_t_err is 0.10765646398067474
-----
before, dynamic flow loss is 0.6385564208030701
predicted weight is 0.2921217083930969
predicted dynamic weight is 0.2683175802230835
predicted dynamic flow loss is 0.655996561050415
predicted flow loss is 2.5343174934387207
predicted flow delta is -0.09405612200498581
first residual should be -0.017440134659409523
dyna residual is -0.017440134659409523
dyna residual is 0.029219569638371468
dyna residual is 0.028776364400982857
dyna residual is 0.028859201818704605
dyna residual is 0.028833698481321335
dyna residual is 0.02883717603981495
dyna residual is 0.028837857767939568
dyna residual is 0.028846528381109238
-----
after optimization
geo loss is 8.069549473077586e-09
r_err is 2.643457719386788e-08
t_err is 7.608178975715418e-09
ob_loss is 0.15973040461540222
ob_r_err is 5.155937194824219
ob_t_err is 0.06969236582517624
-----
bad optimization!
-----
before optimization
geo loss is 1.1094448026938153e-08
r_err is 3.696587214108149e-08
t_err is 1.0449271670154303e-08
ob_loss is 0.480638712644577
ob_r_err is 8.44578742980957
ob_t_err is 0.33268967270851135
-----
before, dynamic flow loss is 4.896212577819824
predicted weight is 0.18283340334892273
predicted dynamic weight is 0.020642468705773354
predicted dynamic flow loss is 7.037867069244385
predicted flow loss is 4.253242015838623
predicted flow delta is -0.14578184485435486
first residual should be -2.1416544914245605
dyna residual is -2.1416544914245605
dyna residual is -0.44355008006095886
dyna residual is 0.6858736872673035
dyna residual is 0.2129439115524292
dyna residual is 0.4833686947822571
dyna residual is -1.0664002895355225
dyna residual is -0.06840720772743225
dyna residual is 0.6889946460723877
-----
after optimization
geo loss is 4.885781024199787e-08
r_err is 4.3178678765798395e-07
t_err is 4.1321708721397954e-08
ob_loss is 3.8903398513793945
ob_r_err is 39.9462776184082
ob_t_err is 2.99394154548645
-----
bad optimization!
-----
before optimization
geo loss is 3.053792552165646e-09
r_err is 9.063719375035362e-08
t_err is 1.4718750662723323e-09
ob_loss is 0.03177396208047867
ob_r_err is 3.81389440917701e-06
ob_t_err is 0.031773895025253296
-----
before, dynamic flow loss is 0.2533651888370514
predicted weight is 0.029438158497214317
predicted dynamic weight is 0.055312853306531906
predicted dynamic flow loss is 0.46972745656967163
predicted flow loss is 5.244322776794434
predicted flow delta is 0.11230020970106125
first residual should be -0.21636225283145905
dyna residual is -0.21636225283145905
dyna residual is -0.32448554039001465
dyna residual is -0.02725229226052761
dyna residual is 0.02335279993712902
dyna residual is 0.07232171297073364
dyna residual is 0.07187290489673615
dyna residual is 0.08418510109186172
dyna residual is 0.08241033554077148
-----
after optimization
geo loss is 3.053792552165646e-09
r_err is 9.063719375035362e-08
t_err is 1.4718750662723323e-09
ob_loss is 0.20398570597171783
ob_r_err is 4.428827285766602
ob_t_err is 0.1266234815120697
-----
bad optimization!
-----
before optimization
geo loss is 3.2249465320433046e-09
r_err is 1.301494023664418e-07
t_err is 9.534107947573034e-10
ob_loss is 0.10415493696928024
ob_r_err is 0.0
ob_t_err is 0.10415493696928024
-----
before, dynamic flow loss is 0.3108462691307068
predicted weight is 0.20075568556785583
predicted dynamic weight is 0.059024911373853683
predicted dynamic flow loss is 0.02779320999979973
predicted flow loss is 3.998187780380249
predicted flow delta is 0.3287356197834015
first residual should be 0.2830530107021332
dyna residual is 0.2830530107021332
dyna residual is 0.025706712156534195
dyna residual is -0.2203626185655594
dyna residual is 0.3496687114238739
dyna residual is -0.027131665498018265
dyna residual is -0.1241673082113266
dyna residual is -0.17002226412296295
dyna residual is -0.1112319752573967
-----
after optimization
geo loss is 3.2249465320433046e-09
r_err is 1.301494023664418e-07
t_err is 9.534107947573034e-10
ob_loss is 0.5588836669921875
ob_r_err is 13.07738971710205
ob_t_err is 0.3297365605831146
-----
bad optimization!
[    60,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,    12.9068,     0.4783,     0.0909,     0.1364,     1.7533,     3.6553,     0.2925,     7.8438,     0.1706,     0.2252,     0.9711,    11.1983,     0.1429,     0.0000,     0.0000,     0.0000,     0.0000,     0.7172,     3.6553,     0.0000,    11.1983,     7.8438,     0.0000, 
-----
before optimization
geo loss is 3.241268142772924e-09
r_err is 7.703734183905908e-08
t_err is 1.89671278683079e-09
ob_loss is 0.2203420102596283
ob_r_err is 0.3515096604824066
ob_t_err is 0.21420630812644958
-----
before, dynamic flow loss is 1.6726340055465698
predicted weight is 0.1308029145002365
predicted dynamic weight is 0.13403083384037018
predicted dynamic flow loss is 2.1103768348693848
predicted flow loss is 4.614932537078857
predicted flow delta is 0.19254423677921295
first residual should be -0.4377428889274597
dyna residual is -0.4377428889274597
dyna residual is -0.5126791596412659
dyna residual is -0.26280850172042847
dyna residual is -0.2651066184043884
dyna residual is -0.21198853850364685
dyna residual is -0.1695833057165146
dyna residual is -0.1663191169500351
dyna residual is -0.16611851751804352
-----
after optimization
geo loss is 3.241268142772924e-09
r_err is 7.703734183905908e-08
t_err is 1.89671278683079e-09
ob_loss is 0.4082146883010864
ob_r_err is 7.336681365966797
ob_t_err is 0.27990055084228516
-----
bad optimization!
-----
before optimization
geo loss is 3.9695297049391343e-10
r_err is 1.4163167527669884e-08
t_err is 1.4975905238134857e-10
ob_loss is 0.009282957762479782
ob_r_err is 0.11561042815446854
ob_t_err is 0.007265173830091953
-----
before, dynamic flow loss is 0.00943455845117569
predicted weight is 0.5766686201095581
predicted dynamic weight is 0.7115104794502258
predicted dynamic flow loss is 0.039361752569675446
predicted flow loss is 0.27668145298957825
predicted flow delta is 0.0006587912794202566
first residual should be -0.029927197843790054
dyna residual is -0.029927197843790054
dyna residual is -0.026411596685647964
dyna residual is -0.02412218600511551
dyna residual is -0.026130512356758118
dyna residual is -0.024827580899000168
dyna residual is -0.025627952069044113
dyna residual is -0.025123611092567444
dyna residual is -0.025416254997253418
-----
after optimization
geo loss is 3.9695297049391343e-10
r_err is 1.4163167527669884e-08
t_err is 1.4975905238134857e-10
ob_loss is 0.046326879411935806
ob_r_err is 1.0275970697402954
ob_t_err is 0.028390973806381226
-----
bad optimization!
-----
before optimization
geo loss is 7.722474215654529e-09
r_err is 2.756521837454784e-07
t_err is 2.9114366473237396e-09
ob_loss is 0.3000473082065582
ob_r_err is 0.9179410338401794
ob_t_err is 0.28401461243629456
-----
before, dynamic flow loss is 0.6037847995758057
predicted weight is 0.11841295659542084
predicted dynamic weight is 0.06851283460855484
predicted dynamic flow loss is 1.5294299125671387
predicted flow loss is 4.961969375610352
predicted flow delta is -0.314059853553772
first residual should be -0.9256452918052673
dyna residual is -0.9256452918052673
dyna residual is 12.76819133758545
dyna residual is 4.0347514152526855
dyna residual is 1.3503588438034058
dyna residual is 2.922572374343872
dyna residual is -1.0567864179611206
dyna residual is 8.373862266540527
dyna residual is 1.2815011739730835
-----
after optimization
geo loss is 7.722474215654529e-09
r_err is 2.756521837454784e-07
t_err is 2.9114366473237396e-09
ob_loss is 5.6374335289001465
ob_r_err is 37.381309509277344
ob_t_err is 4.594242572784424
-----
bad optimization!
-----
before optimization
geo loss is 4.580742007931349e-09
r_err is 1.2261314452644e-07
t_err is 2.440738944287091e-09
ob_loss is 0.1270337551832199
ob_r_err is 0.0
ob_t_err is 0.1270337551832199
-----
before, dynamic flow loss is 0.4234873950481415
predicted weight is 0.16337062418460846
predicted dynamic weight is 0.04595743492245674
predicted dynamic flow loss is 0.13699732720851898
predicted flow loss is 4.433990955352783
predicted flow delta is 0.2530471980571747
first residual should be 0.2864901125431061
dyna residual is 0.2864901125431061
dyna residual is 0.20907336473464966
dyna residual is -0.25392666459083557
dyna residual is 0.15797197818756104
dyna residual is -0.08997604995965958
dyna residual is 0.016881879419088364
dyna residual is -0.01667241007089615
dyna residual is 0.0015075909905135632
-----
after optimization
geo loss is 4.580742007931349e-09
r_err is 1.2261314452644e-07
t_err is 2.440738944287091e-09
ob_loss is 1.9128680229187012
ob_r_err is 38.191200256347656
ob_t_err is 1.1784210205078125
-----
bad optimization!
-----
before optimization
geo loss is 2.8468165602646422e-09
r_err is 6.290472498449162e-08
t_err is 1.7489216741495284e-09
ob_loss is 0.09457191824913025
ob_r_err is 0.21877411007881165
ob_t_err is 0.0907534584403038
-----
before, dynamic flow loss is -0.4352574050426483
predicted weight is 0.19144590198993683
predicted dynamic weight is 0.20270216464996338
predicted dynamic flow loss is -0.0701289027929306
predicted flow loss is 2.5804195404052734
predicted flow delta is -0.7198104858398438
first residual should be -0.3651284873485565
dyna residual is -0.3651284873485565
dyna residual is -0.0850551500916481
dyna residual is 0.04160551726818085
dyna residual is 0.049330588430166245
dyna residual is 0.04978977516293526
dyna residual is 0.049812305718660355
dyna residual is 0.049847930669784546
dyna residual is 0.04984224960207939
-----
after optimization
geo loss is 2.8468165602646422e-09
r_err is 6.290472498449162e-08
t_err is 1.7489216741495284e-09
ob_loss is 0.380880743265152
ob_r_err is 4.061161994934082
ob_t_err is 0.3099013566970825
-----
bad optimization!
-----
before optimization
geo loss is 3.514470714449658e-09
r_err is 8.130964346264591e-08
t_err is 2.0953496715492292e-09
ob_loss is 0.03083113580942154
ob_r_err is 8.984959094959777e-06
ob_t_err is 0.030830979347229004
-----
before, dynamic flow loss is -0.13432380557060242
predicted weight is 0.03505049645900726
predicted dynamic weight is 0.05539150908589363
predicted dynamic flow loss is 0.32978448271751404
predicted flow loss is 5.06138277053833
predicted flow delta is 0.23578277230262756
first residual should be -0.46410828828811646
dyna residual is -0.46410828828811646
dyna residual is -0.08649886399507523
dyna residual is -0.17319802939891815
dyna residual is -0.10957937687635422
dyna residual is -0.1286502182483673
dyna residual is -0.15094605088233948
dyna residual is -0.07354715466499329
dyna residual is -0.13506178557872772
-----
after optimization
geo loss is 3.514470714449658e-09
r_err is 8.130964346264591e-08
t_err is 2.0953496715492292e-09
ob_loss is 0.3036813735961914
ob_r_err is 7.385136127471924
ob_t_err is 0.1742682307958603
-----
bad optimization!
-----
before optimization
geo loss is 3.939623738347109e-09
r_err is 1.710236148255717e-07
t_err is 9.546985424435661e-10
ob_loss is 0.2460632473230362
ob_r_err is 2.988203763961792
ob_t_err is 0.19382427632808685
-----
before, dynamic flow loss is 0.3802989423274994
predicted weight is 0.1879989057779312
predicted dynamic weight is 0.3682197332382202
predicted dynamic flow loss is 0.6300385594367981
predicted flow loss is 3.338351011276245
predicted flow delta is -0.11093829572200775
first residual should be -0.2497396320104599
dyna residual is -0.2497396320104599
dyna residual is -0.032892562448978424
dyna residual is -0.03705854341387749
dyna residual is -0.032171498984098434
dyna residual is -0.034622497856616974
dyna residual is -0.036508958786726
dyna residual is -0.03557966277003288
dyna residual is -0.03643190488219261
-----
after optimization
geo loss is 3.939623738347109e-09
r_err is 1.710236148255717e-07
t_err is 9.546985424435661e-10
ob_loss is 0.6296201944351196
ob_r_err is 12.477920532226562
ob_t_err is 0.41096940636634827
-----
bad optimization!
-----
before optimization
geo loss is 7.190691597713794e-09
r_err is 6.241093331027514e-08
t_err is 6.101415372938845e-09
ob_loss is 0.5851393342018127
ob_r_err is 2.626389741897583
ob_t_err is 0.5391436815261841
-----
before, dynamic flow loss is 0.4365695118904114
predicted weight is 0.26565349102020264
predicted dynamic weight is 0.16250979900360107
predicted dynamic flow loss is 1.0117305517196655
predicted flow loss is 2.5872223377227783
predicted flow delta is 0.04619569703936577
first residual should be -0.5751610398292542
dyna residual is -0.5751610398292542
dyna residual is -0.8577147722244263
dyna residual is -0.03523722663521767
dyna residual is -0.07898546755313873
dyna residual is -0.03568487986922264
dyna residual is -0.040040723979473114
dyna residual is -0.03885005787014961
dyna residual is -0.03892011195421219
-----
after optimization
geo loss is 7.190691597713794e-09
r_err is 6.241093331027514e-08
t_err is 6.101415372938845e-09
ob_loss is 2.5510075092315674
ob_r_err is 14.999900817871094
ob_t_err is 2.2608301639556885
-----
bad optimization!
-----
before optimization
geo loss is 4.498653005668984e-09
r_err is 1.0219672219591303e-07
t_err is 2.714983793339343e-09
ob_loss is 0.12806381285190582
ob_r_err is 1.044763445854187
ob_t_err is 0.10982555150985718
-----
before, dynamic flow loss is 0.01773916184902191
predicted weight is 0.14196845889091492
predicted dynamic weight is 0.1414884477853775
predicted dynamic flow loss is -0.40021055936813354
predicted flow loss is 4.4206671714782715
predicted flow delta is 0.06349466741085052
first residual should be 0.41794973611831665
dyna residual is 0.41794973611831665
dyna residual is -0.0025438752491027117
dyna residual is 0.4504278898239136
dyna residual is -2.4180214405059814
dyna residual is -0.3646838366985321
dyna residual is -0.05791716277599335
dyna residual is -0.08834989368915558
dyna residual is -0.04289434850215912
-----
after optimization
geo loss is 4.498653005668984e-09
r_err is 1.0219672219591303e-07
t_err is 2.714983793339343e-09
ob_loss is 0.7890053987503052
ob_r_err is 17.308069229125977
ob_t_err is 0.479111909866333
-----
bad optimization!
-----
before optimization
geo loss is 1.6519968726314005e-09
r_err is 3.6960848603939667e-08
t_err is 1.006908445511101e-09
ob_loss is 0.07103080302476883
ob_r_err is 0.0
ob_t_err is 0.07103080302476883
-----
before, dynamic flow loss is 0.21491295099258423
predicted weight is 0.2807367742061615
predicted dynamic weight is 0.12225428968667984
predicted dynamic flow loss is 0.2997446656227112
predicted flow loss is 2.156435251235962
predicted flow delta is 0.0015585420187562704
first residual should be -0.08483168482780457
dyna residual is -0.08483168482780457
dyna residual is 0.15020743012428284
dyna residual is -0.16240482032299042
dyna residual is -0.16115441918373108
dyna residual is 0.7487882971763611
dyna residual is 0.13764341175556183
dyna residual is -0.006120924372226
dyna residual is 0.03253241628408432
-----
after optimization
geo loss is 1.6519968726314005e-09
r_err is 3.6960848603939667e-08
t_err is 1.006908445511101e-09
ob_loss is 1.0263092517852783
ob_r_err is 19.724559783935547
ob_t_err is 0.6701766848564148
-----
bad optimization!
-----
before optimization
geo loss is 3.6220069166148505e-09
r_err is 1.4926963842754049e-07
t_err is 1.0167604536093222e-09
ob_loss is 0.32235318422317505
ob_r_err is 8.301039695739746
ob_t_err is 0.17721447348594666
-----
before, dynamic flow loss is 0.35965174436569214
predicted weight is 0.13877862691879272
predicted dynamic weight is 0.06319166719913483
predicted dynamic flow loss is 0.4303005635738373
predicted flow loss is 3.5901296138763428
predicted flow delta is -0.24901284277439117
first residual should be -0.07064885646104813
dyna residual is -0.07064885646104813
dyna residual is 0.0025148377753794193
dyna residual is -0.015161787159740925
dyna residual is 0.009523415938019753
dyna residual is -0.0016741283470764756
dyna residual is -0.008649002760648727
dyna residual is -0.011566570959985256
dyna residual is 0.02273344248533249
-----
after optimization
geo loss is 3.6220069166148505e-09
r_err is 1.4926963842754049e-07
t_err is 1.0167604536093222e-09
ob_loss is 0.937178373336792
ob_r_err is 10.210904121398926
ob_t_err is 0.7557220458984375
-----
bad optimization!
-----
before optimization
geo loss is 3.3364391249790515e-09
r_err is 1.6708081318483892e-07
t_err is 4.2032866076624487e-10
ob_loss is 0.13964110612869263
ob_r_err is 1.3345690965652466
ob_t_err is 0.11633825302124023
-----
before, dynamic flow loss is -2.986778497695923
predicted weight is 0.1275578886270523
predicted dynamic weight is 0.19873744249343872
predicted dynamic flow loss is -3.2753612995147705
predicted flow loss is 4.2777628898620605
predicted flow delta is 0.05378282815217972
first residual should be 0.2885826826095581
dyna residual is 0.2885826826095581
dyna residual is 0.6399651169776917
dyna residual is -0.6862859129905701
dyna residual is 3.5799150466918945
dyna residual is 4.138669967651367
dyna residual is -1.9024981260299683
dyna residual is 0.2539826035499573
dyna residual is 0.05400500074028969
-----
after optimization
geo loss is 3.3364391249790515e-09
r_err is 1.6708081318483892e-07
t_err is 4.2032866076624487e-10
ob_loss is 1.3777436017990112
ob_r_err is 17.84259796142578
ob_t_err is 1.0555964708328247
-----
bad optimization!
-----
before optimization
geo loss is 1.2470597887670465e-08
r_err is 6.329162260954035e-08
t_err is 1.1365950847164186e-08
ob_loss is 0.4079219102859497
ob_r_err is 9.082013130187988
ob_t_err is 0.2489711195230484
-----
before, dynamic flow loss is 20.419204711914062
predicted weight is 0.2019573450088501
predicted dynamic weight is 0.0003669078869279474
predicted dynamic flow loss is 21.96829605102539
predicted flow loss is 4.103105545043945
predicted flow delta is -0.3288864493370056
first residual should be -1.5490894317626953
dyna residual is -1.5490894317626953
dyna residual is -0.7516477108001709
dyna residual is 0.05897195264697075
dyna residual is 1.018938422203064
dyna residual is -0.8459874987602234
dyna residual is -0.3676358461380005
dyna residual is -0.5079135894775391
dyna residual is -0.261434942483902
-----
after optimization
geo loss is 1.2470597887670465e-08
r_err is 6.329162260954035e-08
t_err is 1.1365950847164186e-08
ob_loss is 4.700153350830078
ob_r_err is 50.70237350463867
ob_t_err is 3.108238935470581
-----
bad optimization!
-----
before optimization
geo loss is 9.961024227678195e-10
r_err is 3.754373167907943e-08
t_err is 3.408406890059723e-10
ob_loss is 0.0652228370308876
ob_r_err is 2.380031108856201
ob_t_err is 0.023678407073020935
-----
before, dynamic flow loss is 0.057635340839624405
predicted weight is 0.17570768296718597
predicted dynamic weight is 0.5514925122261047
predicted dynamic flow loss is 0.0638980120420456
predicted flow loss is 2.0099716186523438
predicted flow delta is -0.11627980321645737
first residual should be -0.0062626684084534645
dyna residual is -0.0062626684084534645
dyna residual is -0.010803556069731712
dyna residual is 0.09325817972421646
dyna residual is -0.06037682294845581
dyna residual is 0.06018657609820366
dyna residual is -0.006620418280363083
dyna residual is 0.02009602077305317
dyna residual is 0.009144596755504608
-----
after optimization
geo loss is 9.961024227678195e-10
r_err is 3.754373167907943e-08
t_err is 3.408406890059723e-10
ob_loss is 0.4699278473854065
ob_r_err is 9.829377174377441
ob_t_err is 0.29731103777885437
-----
bad optimization!
-----
before optimization
geo loss is 4.424575816841525e-09
r_err is 8.154326991416383e-08
t_err is 3.001377146816253e-09
ob_loss is 0.11732473969459534
ob_r_err is 0.9958158135414124
ob_t_err is 0.09994086623191833
-----
before, dynamic flow loss is 0.05410216003656387
predicted weight is 0.2471080869436264
predicted dynamic weight is 0.25272196531295776
predicted dynamic flow loss is -0.3389047384262085
predicted flow loss is 3.930988311767578
predicted flow delta is -0.0029434296302497387
first residual should be 0.3930068910121918
dyna residual is 0.3930068910121918
dyna residual is -0.17722851037979126
dyna residual is 0.4271811544895172
dyna residual is -1.2348641157150269
dyna residual is -0.17330530285835266
dyna residual is -0.134648859500885
dyna residual is -0.14223553240299225
dyna residual is -0.1345915049314499
-----
after optimization
geo loss is 4.424575816841525e-09
r_err is 8.154326991416383e-08
t_err is 3.001377146816253e-09
ob_loss is 0.7879471778869629
ob_r_err is 16.583843231201172
ob_t_err is 0.4888606667518616
-----
bad optimization!
-----
before optimization
geo loss is 9.209523699205135e-10
r_err is 2.7042712957836557e-08
t_err is 4.4896802942062664e-10
ob_loss is 0.24857595562934875
ob_r_err is 9.420851707458496
ob_t_err is 0.08398710936307907
-----
before, dynamic flow loss is 0.7733984589576721
predicted weight is 0.6516624093055725
predicted dynamic weight is 0.05870639160275459
predicted dynamic flow loss is 0.5302675366401672
predicted flow loss is 1.2872487306594849
predicted flow delta is -0.0013174808118492365
first residual should be 0.24313099682331085
dyna residual is 0.24313099682331085
dyna residual is 0.1528238207101822
dyna residual is 0.16064275801181793
dyna residual is 0.07171523571014404
dyna residual is 0.0698036178946495
dyna residual is 0.05646056681871414
dyna residual is 0.054933253675699234
dyna residual is 0.05041436105966568
-----
after optimization
geo loss is 9.209523699205135e-10
r_err is 2.7042712957836557e-08
t_err is 4.4896802942062664e-10
ob_loss is 0.8602822422981262
ob_r_err is 21.453702926635742
ob_t_err is 0.4806961417198181
-----
bad optimization!
-----
before optimization
geo loss is 3.5889675675804256e-09
r_err is 8.875870349811521e-08
t_err is 2.0398360778273172e-09
ob_loss is 0.032163847237825394
ob_r_err is 0.0
ob_t_err is 0.032163847237825394
-----
before, dynamic flow loss is -0.0027360001113265753
predicted weight is 0.029439309611916542
predicted dynamic weight is 0.054640993475914
predicted dynamic flow loss is 0.5177701711654663
predicted flow loss is 5.200177192687988
predicted flow delta is 0.11282233893871307
first residual should be -0.5205062031745911
dyna residual is -0.5205062031745911
dyna residual is -0.2077200561761856
dyna residual is -0.03407888859510422
dyna residual is -0.04904735088348389
dyna residual is 0.055702582001686096
dyna residual is -0.019097352400422096
dyna residual is 0.06491661816835403
dyna residual is -0.014308061450719833
-----
after optimization
geo loss is 3.5889675675804256e-09
r_err is 8.875870349811521e-08
t_err is 2.0398360778273172e-09
ob_loss is 0.3706139326095581
ob_r_err is 8.600757598876953
ob_t_err is 0.22013051807880402
-----
bad optimization!
-----
before optimization
geo loss is 3.4638754087268353e-09
r_err is 1.0129328131824877e-07
t_err is 1.6959741389044325e-09
ob_loss is 0.13564720749855042
ob_r_err is 2.4373250007629395
ob_t_err is 0.09308373183012009
-----
before, dynamic flow loss is 0.7154600024223328
predicted weight is 0.5469833016395569
predicted dynamic weight is 0.06951823830604553
predicted dynamic flow loss is 0.6958100199699402
predicted flow loss is 1.6756740808486938
predicted flow delta is -0.07333297282457352
first residual should be 0.019649969413876534
dyna residual is 0.019649969413876534
dyna residual is 0.25023216009140015
dyna residual is 0.21772444248199463
dyna residual is 0.21619215607643127
dyna residual is 0.22078803181648254
dyna residual is 0.2154286652803421
dyna residual is 0.21670664846897125
dyna residual is 0.21570985019207
-----
after optimization
geo loss is 3.4638754087268353e-09
r_err is 1.0129328131824877e-07
t_err is 1.6959741389044325e-09
ob_loss is 0.697384238243103
ob_r_err is 15.904151916503906
ob_t_err is 0.41781678795814514
-----
bad optimization!
-----
before optimization
geo loss is 1.693877260677823e-09
r_err is 8.365014281253025e-08
t_err is 2.339067550760632e-10
ob_loss is 0.24911993741989136
ob_r_err is 8.40735912322998
ob_t_err is 0.10220152884721756
-----
before, dynamic flow loss is 1.2893013954162598
predicted weight is 0.2485097497701645
predicted dynamic weight is 0.3562770187854767
predicted dynamic flow loss is 1.0790079832077026
predicted flow loss is 2.7195489406585693
predicted flow delta is -0.013391954824328423
first residual should be 0.21029330790042877
dyna residual is 0.21029330790042877
dyna residual is 0.1727791726589203
dyna residual is 0.15111656486988068
dyna residual is 0.15129370987415314
dyna residual is 0.15061213076114655
dyna residual is 0.15086185932159424
dyna residual is 0.15068961679935455
dyna residual is 0.15081249177455902
-----
after optimization
geo loss is 1.693877260677823e-09
r_err is 8.365014281253025e-08
t_err is 2.339067550760632e-10
ob_loss is 0.24160322546958923
ob_r_err is 9.400382995605469
ob_t_err is 0.07734771072864532
-----
bad optimization!
-----
before optimization
geo loss is 3.6168659178770213e-09
r_err is 1.1365326457735137e-07
t_err is 1.6332423191656176e-09
ob_loss is 0.3885315954685211
ob_r_err is 7.607602596282959
ob_t_err is 0.25540366768836975
-----
before, dynamic flow loss is 1.3895905017852783
predicted weight is 0.18823324143886566
predicted dynamic weight is 0.12722575664520264
predicted dynamic flow loss is 1.4202253818511963
predicted flow loss is 3.210026979446411
predicted flow delta is -0.16815704107284546
first residual should be -0.03063499741256237
dyna residual is -0.03063499741256237
dyna residual is 0.007854904048144817
dyna residual is -0.04017714411020279
dyna residual is -0.016790293157100677
dyna residual is -0.0318593867123127
dyna residual is -0.02087274193763733
dyna residual is -0.02634088322520256
dyna residual is -0.023387638852000237
-----
after optimization
geo loss is 3.6168659178770213e-09
r_err is 1.1365326457735137e-07
t_err is 1.6332423191656176e-09
ob_loss is 0.8016044497489929
ob_r_err is 7.65674352645874
ob_t_err is 0.6668688654899597
-----
bad optimization!
[    80,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,    16.4039,     0.8977,     0.0909,     0.1000,     2.1681,     3.3216,     0.3498,     7.8295,     0.1924,     0.2011,     0.9774,    11.7408,     0.1739,     0.0000,     0.0000,     0.0000,     0.0000,     1.2465,     3.3209,     0.0000,    11.7408,     7.8295,     0.0000, 
-----
before optimization
geo loss is 1.9380492766174484e-09
r_err is 5.885803844307702e-08
t_err is 9.107828935484008e-10
ob_loss is 0.05862731114029884
ob_r_err is 1.8238639831542969
ob_t_err is 0.026792990043759346
-----
before, dynamic flow loss is 0.16433589160442352
predicted weight is 0.0672910138964653
predicted dynamic weight is 0.1703968495130539
predicted dynamic flow loss is 0.08554279804229736
predicted flow loss is 5.1315412521362305
predicted flow delta is 0.1355869621038437
first residual should be 0.07879310101270676
dyna residual is 0.07879310101270676
dyna residual is 0.032845720648765564
dyna residual is 0.026178207248449326
dyna residual is 0.024528473615646362
dyna residual is 0.02465084381401539
dyna residual is 0.024544617161154747
dyna residual is 0.024558715522289276
dyna residual is 0.024546783417463303
-----
after optimization
geo loss is 1.9380492766174484e-09
r_err is 5.885803844307702e-08
t_err is 9.107828935484008e-10
ob_loss is 0.12053932249546051
ob_r_err is 4.488361358642578
ob_t_err is 0.04218876361846924
-----
bad optimization!
-----
before optimization
geo loss is 6.918078332418531e-10
r_err is 2.0149137469616107e-08
t_err is 3.4013908356556044e-10
ob_loss is 0.05978498235344887
ob_r_err is 2.2046866416931152
ob_t_err is 0.021302174776792526
-----
before, dynamic flow loss is 0.030920540913939476
predicted weight is 0.16922786831855774
predicted dynamic weight is 0.4650498032569885
predicted dynamic flow loss is 0.03212924674153328
predicted flow loss is 1.2482234239578247
predicted flow delta is -0.062391139566898346
first residual should be -0.001208705361932516
dyna residual is -0.001208705361932516
dyna residual is -0.023004963994026184
dyna residual is 0.09420160949230194
dyna residual is -0.029105061665177345
dyna residual is 0.05354570969939232
dyna residual is 0.02704448252916336
dyna residual is 0.03583359345793724
dyna residual is 0.03372237831354141
-----
after optimization
geo loss is 6.918078332418531e-10
r_err is 2.0149137469616107e-08
t_err is 3.4013908356556044e-10
ob_loss is 0.5490127801895142
ob_r_err is 11.2128267288208
ob_t_err is 0.35024961829185486
-----
bad optimization!
-----
before optimization
geo loss is 6.918078332418531e-10
r_err is 2.0149137469616107e-08
t_err is 3.4013908356556044e-10
ob_loss is 0.5490127801895142
ob_r_err is 11.2128267288208
ob_t_err is 0.35024961829185486
-----
before, dynamic flow loss is 0.0666239857673645
predicted weight is 0.18473705649375916
predicted dynamic weight is 0.6275087594985962
predicted dynamic flow loss is 0.03431335464119911
predicted flow loss is 1.239696741104126
predicted flow delta is -0.059586260467767715
first residual should be 0.032310646027326584
dyna residual is 0.032310646027326584
dyna residual is 0.042709995061159134
dyna residual is 0.04941904917359352
dyna residual is 0.047831613570451736
dyna residual is 0.048085834830999374
dyna residual is 0.04806436970829964
dyna residual is 0.048062365502119064
dyna residual is 0.04806438460946083
-----
after optimization
geo loss is 6.918078332418531e-10
r_err is 2.0149137469616107e-08
t_err is 3.4013908356556044e-10
ob_loss is 0.7981188893318176
ob_r_err is 15.541664123535156
ob_t_err is 0.5163443088531494
-----
bad optimization!
-----
before optimization
geo loss is 1.6220480514306246e-09
r_err is 6.74097435648946e-08
t_err is 4.455262270219862e-10
ob_loss is 0.16165775060653687
ob_r_err is 4.676144123077393
ob_t_err is 0.07999908924102783
-----
before, dynamic flow loss is 0.28350570797920227
predicted weight is 0.5832412838935852
predicted dynamic weight is 0.08659078180789948
predicted dynamic flow loss is 0.48738476634025574
predicted flow loss is 1.4235494136810303
predicted flow delta is 0.009291849099099636
first residual should be -0.20387905836105347
dyna residual is -0.20387905836105347
dyna residual is -0.07083386182785034
dyna residual is -0.039188697934150696
dyna residual is -0.10741026699542999
dyna residual is -0.03386841341853142
dyna residual is -0.09383049607276917
dyna residual is -0.03835837170481682
dyna residual is -0.07600009441375732
-----
after optimization
geo loss is 1.6220480514306246e-09
r_err is 6.74097435648946e-08
t_err is 4.455262270219862e-10
ob_loss is 0.41294968128204346
ob_r_err is 8.523849487304688
ob_t_err is 0.2636564373970032
-----
bad optimization!
-----
before optimization
geo loss is 3.4651337355029455e-09
r_err is 1.8467633822183416e-07
t_err is 2.419237865591839e-10
ob_loss is 0.2624675929546356
ob_r_err is 7.5450053215026855
ob_t_err is 0.13058099150657654
-----
before, dynamic flow loss is 0.2241915911436081
predicted weight is 0.11801023781299591
predicted dynamic weight is 0.09673216938972473
predicted dynamic flow loss is 0.3058001697063446
predicted flow loss is 4.35951566696167
predicted flow delta is 0.032337747514247894
first residual should be -0.08160854130983353
dyna residual is -0.08160854130983353
dyna residual is -0.028199978172779083
dyna residual is -0.03390863165259361
dyna residual is -0.04850341007113457
dyna residual is -0.03075820952653885
dyna residual is -0.04881610721349716
dyna residual is -0.030483201146125793
dyna residual is -0.04700697585940361
-----
after optimization
geo loss is 3.4651337355029455e-09
r_err is 1.8467633822183416e-07
t_err is 2.419237865591839e-10
ob_loss is 0.5562145709991455
ob_r_err is 6.519534111022949
ob_t_err is 0.4420255422592163
-----
bad optimization!
-----
before optimization
geo loss is 9.574981918447634e-10
r_err is 4.4796408360525675e-08
t_err is 1.7565329746282998e-10
ob_loss is 0.0760314017534256
ob_r_err is 2.7755753993988037
ob_t_err is 0.02758188173174858
-----
before, dynamic flow loss is 0.07326173037290573
predicted weight is 0.15509533882141113
predicted dynamic weight is 0.5189568400382996
predicted dynamic flow loss is 0.08384882658720016
predicted flow loss is 2.4520952701568604
predicted flow delta is -0.14199958741664886
first residual should be -0.010587086901068687
dyna residual is -0.010587086901068687
dyna residual is -0.03257836028933525
dyna residual is 0.2067631632089615
dyna residual is -0.18864378333091736
dyna residual is 0.06918244808912277
dyna residual is -0.044326093047857285
dyna residual is -0.0013736331602558494
dyna residual is -0.01963004656136036
-----
after optimization
geo loss is 9.574981918447634e-10
r_err is 4.4796408360525675e-08
t_err is 1.7565329746282998e-10
ob_loss is 0.6225776672363281
ob_r_err is 12.584004402160645
ob_t_err is 0.4001515805721283
-----
bad optimization!
-----
before optimization
geo loss is 1.0375491577008233e-09
r_err is 3.159945194397551e-08
t_err is 4.860347679880306e-10
ob_loss is 0.03531430661678314
ob_r_err is 1.1269854307174683
ob_t_err is 0.015643933787941933
-----
before, dynamic flow loss is 0.05972332879900932
predicted weight is 0.15865331888198853
predicted dynamic weight is 0.32399359345436096
predicted dynamic flow loss is 0.0678035095334053
predicted flow loss is 2.7789382934570312
predicted flow delta is -0.16748568415641785
first residual should be -0.008080177940428257
dyna residual is -0.008080177940428257
dyna residual is 0.0019715020898729563
dyna residual is 0.001506240339949727
dyna residual is 0.0017747438978403807
dyna residual is 0.0015478723216801882
dyna residual is 0.0016045685624703765
dyna residual is 0.0015704265097156167
dyna residual is 0.0015804007416591048
-----
after optimization
geo loss is 1.0375491577008233e-09
r_err is 3.159945194397551e-08
t_err is 4.860347679880306e-10
ob_loss is 0.07148203253746033
ob_r_err is 2.927882194519043
ob_t_err is 0.02037680521607399
-----
bad optimization!
-----
before optimization
geo loss is 2.7592852447355654e-09
r_err is 7.933026324735692e-08
t_err is 1.3747111227147002e-09
ob_loss is 0.24247068166732788
ob_r_err is 8.073122024536133
ob_t_err is 0.10136745125055313
-----
before, dynamic flow loss is 0.7925070524215698
predicted weight is 0.6081121563911438
predicted dynamic weight is 0.0446770042181015
predicted dynamic flow loss is 0.7167000770568848
predicted flow loss is 1.324609398841858
predicted flow delta is -0.044976215809583664
first residual should be 0.07580704241991043
dyna residual is 0.07580704241991043
dyna residual is 0.06629332154989243
dyna residual is 0.1874457746744156
dyna residual is 0.056549083441495895
dyna residual is 0.09248604625463486
dyna residual is 0.029495052993297577
dyna residual is 0.06448139995336533
dyna residual is 0.03229828551411629
-----
after optimization
geo loss is 2.7592852447355654e-09
r_err is 7.933026324735692e-08
t_err is 1.3747111227147002e-09
ob_loss is 0.9411942958831787
ob_r_err is 21.470365524291992
ob_t_err is 0.5613985061645508
-----
bad optimization!
-----
before optimization
geo loss is 7.759811126994975e-10
r_err is 3.322066177702254e-08
t_err is 1.9617124591420065e-10
ob_loss is 0.19272983074188232
ob_r_err is 7.318553924560547
ob_t_err is 0.06491998583078384
-----
before, dynamic flow loss is 0.5626656413078308
predicted weight is 0.6367878317832947
predicted dynamic weight is 0.07361694425344467
predicted dynamic flow loss is 0.4936971366405487
predicted flow loss is 1.2932968139648438
predicted flow delta is 0.006176475901156664
first residual should be 0.06896845996379852
dyna residual is 0.06896845996379852
dyna residual is 0.14132504165172577
dyna residual is 0.12381872534751892
dyna residual is 0.1451609879732132
dyna residual is 0.08588265627622604
dyna residual is 0.10906577110290527
dyna residual is 0.07341577112674713
dyna residual is 0.08487766236066818
-----
after optimization
geo loss is 7.759811126994975e-10
r_err is 3.322066177702254e-08
t_err is 1.9617124591420065e-10
ob_loss is 0.6286576390266418
ob_r_err is 15.717483520507812
ob_t_err is 0.3524381220340729
-----
bad optimization!
-----
before optimization
geo loss is 2.462072101749868e-09
r_err is 1.0202911226997458e-07
t_err is 6.813281605566601e-10
ob_loss is 0.12689891457557678
ob_r_err is 1.505114197731018
ob_t_err is 0.10062403231859207
-----
before, dynamic flow loss is 0.06039830669760704
predicted weight is 0.20266608893871307
predicted dynamic weight is 0.2874075770378113
predicted dynamic flow loss is 0.18297676742076874
predicted flow loss is 2.8776817321777344
predicted flow delta is -0.20907390117645264
first residual should be -0.12257847189903259
dyna residual is -0.12257847189903259
dyna residual is -0.07260478287935257
dyna residual is -0.07370614260435104
dyna residual is -0.07388817518949509
dyna residual is -0.07379421591758728
dyna residual is -0.07384688407182693
dyna residual is -0.0738152489066124
dyna residual is -0.07383301109075546
-----
after optimization
geo loss is 2.462072101749868e-09
r_err is 1.0202911226997458e-07
t_err is 6.813281605566601e-10
ob_loss is 0.20944064855575562
ob_r_err is 5.702716827392578
ob_t_err is 0.1098407730460167
-----
bad optimization!
-----
before optimization
geo loss is 2.8067563828670927e-09
r_err is 1.120936303777853e-07
t_err is 8.503532877845998e-10
ob_loss is 0.09065212309360504
ob_r_err is 0.8249068260192871
ob_t_err is 0.07625339925289154
-----
before, dynamic flow loss is -0.49612534046173096
predicted weight is 0.05871574953198433
predicted dynamic weight is 0.14277523756027222
predicted dynamic flow loss is 0.054589953273534775
predicted flow loss is 5.3538007736206055
predicted flow delta is 0.12545691430568695
first residual should be -0.5507152676582336
dyna residual is -0.5507152676582336
dyna residual is 0.06646321713924408
dyna residual is -0.20096226036548615
dyna residual is -0.21190322935581207
dyna residual is -0.21382279694080353
dyna residual is -0.21388591825962067
dyna residual is -0.21422259509563446
dyna residual is -0.21415743231773376
-----
after optimization
geo loss is 2.8067563828670927e-09
r_err is 1.120936303777853e-07
t_err is 8.503532877845998e-10
ob_loss is 0.3267667293548584
ob_r_err is 7.749101161956787
ob_t_err is 0.19128616154193878
-----
bad optimization!
-----
before optimization
geo loss is 7.631205112268447e-10
r_err is 1.4677410398178381e-08
t_err is 5.069513697719685e-10
ob_loss is 0.01920364983379841
ob_r_err is 0.6140366792678833
ob_t_err is 0.00848661083728075
-----
before, dynamic flow loss is 0.01652536168694496
predicted weight is 0.23542729020118713
predicted dynamic weight is 0.46303653717041016
predicted dynamic flow loss is -0.002531234873458743
predicted flow loss is 1.6930192708969116
predicted flow delta is -0.06287510693073273
first residual should be 0.019056595861911774
dyna residual is 0.019056595861911774
dyna residual is 0.024240516126155853
dyna residual is 0.024737108498811722
dyna residual is 0.024377092719078064
dyna residual is 0.02446298487484455
dyna residual is 0.024416839703917503
dyna residual is 0.02442467212677002
dyna residual is 0.02441718801856041
-----
after optimization
geo loss is 7.631205112268447e-10
r_err is 1.4677410398178381e-08
t_err is 5.069513697719685e-10
ob_loss is 0.03761398792266846
ob_r_err is 1.4474995136260986
ob_t_err is 0.012350000441074371
-----
bad optimization!
-----
before optimization
geo loss is 4.046433854654197e-09
r_err is 3.6203715580995777e-08
t_err is 3.4145597460621957e-09
ob_loss is 0.25962570309638977
ob_r_err is 6.5683135986328125
ob_t_err is 0.14483578503131866
-----
before, dynamic flow loss is 0.6487911939620972
predicted weight is 0.26963159441947937
predicted dynamic weight is 0.1383764147758484
predicted dynamic flow loss is 0.4879229664802551
predicted flow loss is 2.9837820529937744
predicted flow delta is -0.0573805570602417
first residual should be 0.16086819767951965
dyna residual is 0.16086819767951965
dyna residual is 0.17771336436271667
dyna residual is 0.18243001401424408
dyna residual is 0.1827644258737564
dyna residual is 0.18282553553581238
dyna residual is 0.18283307552337646
dyna residual is 0.18283765017986298
dyna residual is 0.18283432722091675
-----
after optimization
geo loss is 4.046433854654197e-09
r_err is 3.6203715580995777e-08
t_err is 3.4145597460621957e-09
ob_loss is 0.20939618349075317
ob_r_err is 7.325542449951172
ob_t_err is 0.08145391196012497
-----
bad optimization!
-----
before optimization
geo loss is 1.8304572302341171e-09
r_err is 5.6495643718790234e-08
t_err is 8.444223098535986e-10
ob_loss is 0.09158883988857269
ob_r_err is 3.0640432834625244
ob_t_err is 0.03810354322195053
-----
before, dynamic flow loss is -0.5680777430534363
predicted weight is 0.1821954846382141
predicted dynamic weight is 0.2778831422328949
predicted dynamic flow loss is -0.7766706943511963
predicted flow loss is 2.6344258785247803
predicted flow delta is 0.04626532271504402
first residual should be 0.20859293639659882
dyna residual is 0.20859293639659882
dyna residual is 0.10450036078691483
dyna residual is 0.09473564475774765
dyna residual is 0.05327089503407478
dyna residual is 0.07079704850912094
dyna residual is 0.056291136890649796
dyna residual is 0.05814391374588013
dyna residual is 0.05626998469233513
-----
after optimization
geo loss is 1.8304572302341171e-09
r_err is 5.6495643718790234e-08
t_err is 8.444223098535986e-10
ob_loss is 0.6992942094802856
ob_r_err is 15.14250659942627
ob_t_err is 0.4298626780509949
-----
bad optimization!
-----
before optimization
geo loss is 1.4602501430260872e-09
r_err is 2.046495417573624e-08
t_err is 1.1030693025659843e-09
ob_loss is 0.2802164554595947
ob_r_err is 11.31031322479248
ob_t_err is 0.0825733169913292
-----
before, dynamic flow loss is 0.4861689805984497
predicted weight is 0.7261006236076355
predicted dynamic weight is 0.08845648914575577
predicted dynamic flow loss is 0.3974035680294037
predicted flow loss is 0.8186368346214294
predicted flow delta is -0.035994190722703934
first residual should be 0.08876539021730423
dyna residual is 0.08876539021730423
dyna residual is -0.015360415913164616
dyna residual is -0.032242704182863235
dyna residual is -0.0481083057820797
dyna residual is -0.048914916813373566
dyna residual is -0.05263280123472214
dyna residual is -0.05212992802262306
dyna residual is -0.05323343724012375
-----
after optimization
geo loss is 1.4602501430260872e-09
r_err is 2.046495417573624e-08
t_err is 1.1030693025659843e-09
ob_loss is 0.7132561206817627
ob_r_err is 20.042619705200195
ob_t_err is 0.3602505326271057
-----
bad optimization!
-----
before optimization
geo loss is 1.4776259105175882e-09
r_err is 2.2638594998625194e-08
t_err is 1.0825079721499264e-09
ob_loss is 0.05315073952078819
ob_r_err is 1.5534099340438843
ob_t_err is 0.02603456750512123
-----
before, dynamic flow loss is -0.16375914216041565
predicted weight is 0.35206350684165955
predicted dynamic weight is 0.3635103106498718
predicted dynamic flow loss is 0.3979383707046509
predicted flow loss is 2.2591164112091064
predicted flow delta is -0.06725027412176132
first residual should be -0.5616974830627441
dyna residual is -0.5616974830627441
dyna residual is -0.08896329253911972
dyna residual is -0.13651758432388306
dyna residual is -0.1140933558344841
dyna residual is -0.11636636406183243
dyna residual is -0.1155097559094429
dyna residual is -0.11558323353528976
dyna residual is -0.11555356532335281
-----
after optimization
geo loss is 1.4776259105175882e-09
r_err is 2.2638594998625194e-08
t_err is 1.0825079721499264e-09
ob_loss is 0.13118553161621094
ob_r_err is 3.48722505569458
ob_t_err is 0.07026403397321701
-----
bad optimization!
-----
before optimization
geo loss is 1.027213336612931e-08
r_err is 8.189115163759197e-08
t_err is 8.842863330471573e-09
ob_loss is 0.11601832509040833
ob_r_err is 0.400897741317749
ob_t_err is 0.1090206727385521
-----
before, dynamic flow loss is 0.7045925259590149
predicted weight is 0.037341948598623276
predicted dynamic weight is 0.04231637716293335
predicted dynamic flow loss is 0.372737318277359
predicted flow loss is 7.208205699920654
predicted flow delta is 1.313550353050232
first residual should be 0.3318551778793335
dyna residual is 0.3318551778793335
dyna residual is -0.39541083574295044
dyna residual is -0.16499577462673187
dyna residual is -0.1474282145500183
dyna residual is -0.14835679531097412
dyna residual is -0.14816400408744812
dyna residual is -0.1482505202293396
dyna residual is -0.14822813868522644
-----
after optimization
geo loss is 1.027213336612931e-08
r_err is 8.189115163759197e-08
t_err is 8.842863330471573e-09
ob_loss is 0.20407435297966003
ob_r_err is 3.8026492595672607
ob_t_err is 0.13751137256622314
-----
bad optimization!
-----
before optimization
geo loss is 3.1996194582717408e-09
r_err is 5.584016449233786e-08
t_err is 2.2250246090038672e-09
ob_loss is 0.02231777086853981
ob_r_err is 5.869893357157707e-06
ob_t_err is 0.022317668423056602
-----
before, dynamic flow loss is 0.21348239481449127
predicted weight is 0.0714070051908493
predicted dynamic weight is 0.11170055717229843
predicted dynamic flow loss is 0.14548300206661224
predicted flow loss is 4.205451488494873
predicted flow delta is 0.07636389881372452
first residual should be 0.06799938529729843
dyna residual is 0.06799938529729843
dyna residual is -0.06748360395431519
dyna residual is 0.16712670028209686
dyna residual is 0.18772678077220917
dyna residual is 0.2173989713191986
dyna residual is 0.2156464159488678
dyna residual is 0.22309692203998566
dyna residual is 0.22003498673439026
-----
after optimization
geo loss is 3.1996194582717408e-09
r_err is 5.584016449233786e-08
t_err is 2.2250246090038672e-09
ob_loss is 0.11430756747722626
ob_r_err is 2.308105945587158
ob_t_err is 0.07401441782712936
-----
bad optimization!
-----
before optimization
geo loss is 2.181460123651391e-09
r_err is 6.918218531382081e-08
t_err is 9.740033224403533e-10
ob_loss is 0.0525217205286026
ob_r_err is 1.914903163909912
ob_t_err is 0.0190977044403553
-----
before, dynamic flow loss is -0.002820627996698022
predicted weight is 0.2111976593732834
predicted dynamic weight is 0.2704547941684723
predicted dynamic flow loss is 0.5982178449630737
predicted flow loss is 4.419882774353027
predicted flow delta is -0.12505625188350677
first residual should be -0.6010384559631348
dyna residual is -0.6010384559631348
dyna residual is -5.4139204025268555
dyna residual is -1.9895493984222412
dyna residual is -0.4551759362220764
dyna residual is -0.2972259521484375
dyna residual is -0.6389749646186829
dyna residual is -0.2982380986213684
dyna residual is -0.25680065155029297
-----
after optimization
geo loss is 2.181460123651391e-09
r_err is 6.918218531382081e-08
t_err is 9.740033224403533e-10
ob_loss is 0.729006826877594
ob_r_err is 14.194050788879395
ob_t_err is 0.475233256816864
-----
bad optimization!
-----
before optimization
geo loss is 2.4104409579450703e-09
r_err is 5.7039137857373134e-08
t_err is 1.4149202920421544e-09
ob_loss is 0.07256927341222763
ob_r_err is 0.0
ob_t_err is 0.07256927341222763
-----
before, dynamic flow loss is 0.15036985278129578
predicted weight is 0.28153857588768005
predicted dynamic weight is 0.08141683787107468
predicted dynamic flow loss is 0.04634307324886322
predicted flow loss is 2.576284885406494
predicted flow delta is 0.12725208699703217
first residual should be 0.10402674973011017
dyna residual is 0.10402674973011017
dyna residual is 0.3288693130016327
dyna residual is -0.28697559237480164
dyna residual is 0.07595354318618774
dyna residual is -0.10536117106676102
dyna residual is 0.12178526818752289
dyna residual is -0.12098851054906845
dyna residual is 0.07857495546340942
-----
after optimization
geo loss is 2.4104409579450703e-09
r_err is 5.7039137857373134e-08
t_err is 1.4149202920421544e-09
ob_loss is 0.7442137002944946
ob_r_err is 15.427190780639648
ob_t_err is 0.47026151418685913
-----
bad optimization!
-----
before optimization
geo loss is 1.935174687162089e-09
r_err is 8.929868755558346e-08
t_err is 3.7661845864178645e-10
ob_loss is 0.2952001690864563
ob_r_err is 9.571748733520508
ob_t_err is 0.1278795301914215
-----
before, dynamic flow loss is 1.366977334022522
predicted weight is 0.2217981368303299
predicted dynamic weight is 0.2978375256061554
predicted dynamic flow loss is 1.3843270540237427
predicted flow loss is 3.0324108600616455
predicted flow delta is -0.07240157574415207
first residual should be -0.017349716275930405
dyna residual is -0.017349716275930405
dyna residual is 0.0756770521402359
dyna residual is 0.05460916459560394
dyna residual is 0.05573534965515137
dyna residual is 0.05467486009001732
dyna residual is 0.05528171733021736
dyna residual is 0.0548681765794754
dyna residual is 0.05513068661093712
-----
after optimization
geo loss is 1.935174687162089e-09
r_err is 8.929868755558346e-08
t_err is 3.7661845864178645e-10
ob_loss is 0.29257911443710327
ob_r_err is 10.287023544311523
ob_t_err is 0.1128314882516861
-----
bad optimization!
[   100,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,     9.7345,     0.2562,     0.0909,     0.1182,     1.5900,     3.0033,     0.4005,     6.1531,     0.1576,     0.3624,     0.9545,     8.4318,     0.1544,     0.0000,     0.0000,     0.0000,     0.0000,     0.4281,     3.0033,     0.0000,     8.4318,     6.1531,     0.0000, 
-----
before optimization
geo loss is 2.1676833661388173e-09
r_err is 4.875623460520728e-08
t_err is 1.316726727651485e-09
ob_loss is 0.27192702889442444
ob_r_err is 10.638041496276855
ob_t_err is 0.08601970970630646
-----
before, dynamic flow loss is 0.5295637249946594
predicted weight is 0.692955732345581
predicted dynamic weight is 0.06264841556549072
predicted dynamic flow loss is 0.33197569847106934
predicted flow loss is 0.9706513285636902
predicted flow delta is -0.03175437077879906
first residual should be 0.1975880116224289
dyna residual is 0.1975880116224289
dyna residual is -0.06739021837711334
dyna residual is 0.026846764609217644
dyna residual is 0.020468179136514664
dyna residual is 0.020852360874414444
dyna residual is 0.02068875916302204
dyna residual is 0.021556947380304337
dyna residual is 0.021910127252340317
-----
after optimization
geo loss is 2.1676833661388173e-09
r_err is 4.875623460520728e-08
t_err is 1.316726727651485e-09
ob_loss is 0.86208176612854
ob_r_err is 21.88104248046875
ob_t_err is 0.4754455089569092
-----
bad optimization!
-----
before optimization
geo loss is 2.61840638060562e-09
r_err is 5.67778783988615e-08
t_err is 1.6274455116871422e-09
ob_loss is 0.032321128994226456
ob_r_err is 4.707290288763842e-22
ob_t_err is 0.032321128994226456
-----
before, dynamic flow loss is 0.5264471769332886
predicted weight is 0.03680194914340973
predicted dynamic weight is 0.05209863930940628
predicted dynamic flow loss is 0.5114732384681702
predicted flow loss is 5.161999702453613
predicted flow delta is 0.14180271327495575
first residual should be 0.014973988756537437
dyna residual is 0.014973988756537437
dyna residual is -0.3887588083744049
dyna residual is -0.024437176063656807
dyna residual is 0.03947034105658531
dyna residual is 0.08925655484199524
dyna residual is 0.08818791806697845
dyna residual is 0.11078251153230667
dyna residual is 0.10344401746988297
-----
after optimization
geo loss is 2.61840638060562e-09
r_err is 5.67778783988615e-08
t_err is 1.6274455116871422e-09
ob_loss is 0.11557663977146149
ob_r_err is 1.9929393529891968
ob_t_err is 0.0807899460196495
-----
bad optimization!
-----
before optimization
geo loss is 2.61840638060562e-09
r_err is 5.67778783988615e-08
t_err is 1.6274455116871422e-09
ob_loss is 0.11557663977146149
ob_r_err is 1.9929393529891968
ob_t_err is 0.0807899460196495
-----
before, dynamic flow loss is 0.6285808682441711
predicted weight is 0.05280335247516632
predicted dynamic weight is 0.16529014706611633
predicted dynamic flow loss is 0.21939480304718018
predicted flow loss is 5.353662014007568
predicted flow delta is 0.13197879493236542
first residual should be 0.40918606519699097
dyna residual is 0.40918606519699097
dyna residual is -0.21922992169857025
dyna residual is 0.0035312066320329905
dyna residual is 0.011768117547035217
dyna residual is 0.020685674622654915
dyna residual is 0.019942903891205788
dyna residual is 0.020819369703531265
dyna residual is 0.020590174943208694
-----
after optimization
geo loss is 2.61840638060562e-09
r_err is 5.67778783988615e-08
t_err is 1.6274455116871422e-09
ob_loss is 0.15612509846687317
ob_r_err is 2.2743513584136963
ob_t_err is 0.11642303317785263
-----
bad optimization!
-----
before optimization
geo loss is 4.31452917837305e-09
r_err is 8.378560778510291e-08
t_err is 2.8521942585513216e-09
ob_loss is 0.09738776087760925
ob_r_err is 0.16614456474781036
ob_t_err is 0.09448787569999695
-----
before, dynamic flow loss is -0.028609391301870346
predicted weight is 0.13770103454589844
predicted dynamic weight is 0.1597374677658081
predicted dynamic flow loss is 0.11668775230646133
predicted flow loss is 3.8843941688537598
predicted flow delta is -0.29761502146720886
first residual should be -0.14529713988304138
dyna residual is -0.14529713988304138
dyna residual is 0.17880214750766754
dyna residual is 0.03277859836816788
dyna residual is 0.20330527424812317
dyna residual is 0.18437698483467102
dyna residual is 0.13486605882644653
dyna residual is 0.1367146223783493
dyna residual is 0.12213823944330215
-----
after optimization
geo loss is 8.427625175499998e-08
r_err is 6.543322683683073e-07
t_err is 7.28559967910769e-08
ob_loss is 0.6325045824050903
ob_r_err is 10.200033187866211
ob_t_err is 0.4539078176021576
-----
bad optimization!
-----
before optimization
geo loss is 2.0527672894843363e-09
r_err is 8.304358090072128e-08
t_err is 6.033834543117678e-10
ob_loss is 0.2144462913274765
ob_r_err is 0.2960205078125
ob_t_err is 0.2092791348695755
-----
before, dynamic flow loss is 1.853013038635254
predicted weight is 0.13443928956985474
predicted dynamic weight is 0.21735554933547974
predicted dynamic flow loss is 1.984157919883728
predicted flow loss is 4.661003112792969
predicted flow delta is 0.3127187192440033
first residual should be -0.13114476203918457
dyna residual is -0.13114476203918457
dyna residual is -0.3677571415901184
dyna residual is -0.26463258266448975
dyna residual is -0.26868101954460144
dyna residual is -0.2353752702474594
dyna residual is -0.21279342472553253
dyna residual is -0.2110138237476349
dyna residual is -0.1944444179534912
-----
after optimization
geo loss is 2.0527672894843363e-09
r_err is 8.304358090072128e-08
t_err is 6.033834543117678e-10
ob_loss is 0.7289597988128662
ob_r_err is 11.751858711242676
ob_t_err is 0.5223109126091003
-----
bad optimization!
-----
before optimization
geo loss is 4.751659954393972e-09
r_err is 2.5102303879975807e-07
t_err is 3.704815065841416e-10
ob_loss is 0.08336926996707916
ob_r_err is 0.9663093090057373
ob_t_err is 0.06649691611528397
-----
before, dynamic flow loss is -0.04106184095144272
predicted weight is 0.13054485619068146
predicted dynamic weight is 0.10685256868600845
predicted dynamic flow loss is 0.2434360384941101
predicted flow loss is 4.637668609619141
predicted flow delta is -0.4293774664402008
first residual should be -0.2844978868961334
dyna residual is -0.2844978868961334
dyna residual is 3.574178695678711
dyna residual is 1.342774510383606
dyna residual is 0.5562823414802551
dyna residual is 0.10871804505586624
dyna residual is 0.15135277807712555
dyna residual is 0.20041194558143616
dyna residual is 0.18826235830783844
-----
after optimization
geo loss is 4.751659954393972e-09
r_err is 2.5102303879975807e-07
t_err is 3.704815065841416e-10
ob_loss is 1.9263859987258911
ob_r_err is 37.51106643676758
ob_t_err is 1.2326209545135498
-----
bad optimization!
-----
before optimization
geo loss is 1.1762787410773967e-09
r_err is 4.0895731245882416e-08
t_err is 4.625135274771708e-10
ob_loss is 0.060552820563316345
ob_r_err is 1.1906673908233643
ob_t_err is 0.03977058082818985
-----
before, dynamic flow loss is 0.29628732800483704
predicted weight is 0.30922120809555054
predicted dynamic weight is 0.18751206994056702
predicted dynamic flow loss is 0.34412384033203125
predicted flow loss is 1.3184705972671509
predicted flow delta is 0.04378516972064972
first residual should be -0.047836512327194214
dyna residual is -0.047836512327194214
dyna residual is 0.03817854821681976
dyna residual is -0.019582269713282585
dyna residual is 0.024558186531066895
dyna residual is -0.012870405800640583
dyna residual is 0.019270529970526695
dyna residual is -0.00769716314971447
dyna residual is 0.017093006521463394
-----
after optimization
geo loss is 1.1762787410773967e-09
r_err is 4.0895731245882416e-08
t_err is 4.625135274771708e-10
ob_loss is 0.18473097681999207
ob_r_err is 4.479912757873535
ob_t_err is 0.10650424659252167
-----
bad optimization!
-----
before optimization
geo loss is 9.018355839884862e-09
r_err is 3.03387565736557e-07
t_err is 3.723244379472135e-09
ob_loss is 0.35827404260635376
ob_r_err is 2.7549190521240234
ob_t_err is 0.3101159632205963
-----
before, dynamic flow loss is 0.5960022807121277
predicted weight is 0.07790770381689072
predicted dynamic weight is 0.1352510154247284
predicted dynamic flow loss is 0.8506705164909363
predicted flow loss is 5.037109851837158
predicted flow delta is 0.013869693502783775
first residual should be -0.2546682059764862
dyna residual is -0.2546682059764862
dyna residual is -0.022288616746664047
dyna residual is -1.550978660583496
dyna residual is -4.538428783416748
dyna residual is -5.639852523803711
dyna residual is -1.3029835224151611
dyna residual is -0.4497574269771576
dyna residual is 0.1723233014345169
-----
after optimization
geo loss is 9.018355839884862e-09
r_err is 3.03387565736557e-07
t_err is 3.723244379472135e-09
ob_loss is 13.172607421875
ob_r_err is 102.35551452636719
ob_t_err is 8.048952102661133
-----
bad optimization!
-----
before optimization
geo loss is 3.0367961478816596e-09
r_err is 1.108965719254229e-07
t_err is 1.1012858402992265e-09
ob_loss is 0.07715672999620438
ob_r_err is 0.0
ob_t_err is 0.07715672999620438
-----
before, dynamic flow loss is 0.2501060366630554
predicted weight is 0.18725915253162384
predicted dynamic weight is 0.12531527876853943
predicted dynamic flow loss is 0.2647837996482849
predicted flow loss is 4.3353271484375
predicted flow delta is 0.038454312831163406
first residual should be -0.01467774249613285
dyna residual is -0.01467774249613285
dyna residual is -0.370650976896286
dyna residual is 0.6688017845153809
dyna residual is 0.24587291479110718
dyna residual is 0.4147386848926544
dyna residual is 0.22267118096351624
dyna residual is 0.17796999216079712
dyna residual is 0.17041637003421783
-----
after optimization
geo loss is 3.0367961478816596e-09
r_err is 1.108965719254229e-07
t_err is 1.1012858402992265e-09
ob_loss is 1.3056615591049194
ob_r_err is 24.607717514038086
ob_t_err is 0.8500950932502747
-----
bad optimization!
-----
before optimization
geo loss is 2.3225592560294217e-09
r_err is 8.027317477399265e-08
t_err is 9.215281870922354e-10
ob_loss is 0.08407387137413025
ob_r_err is 0.0
ob_t_err is 0.08407387137413025
-----
before, dynamic flow loss is 0.18254666030406952
predicted weight is 0.22447513043880463
predicted dynamic weight is 0.08073161542415619
predicted dynamic flow loss is -0.0017522514099255204
predicted flow loss is 3.4932568073272705
predicted flow delta is 0.18907006084918976
first residual should be 0.18429890275001526
dyna residual is 0.18429890275001526
dyna residual is 0.018969325348734856
dyna residual is 0.044029172509908676
dyna residual is 0.052300825715065
dyna residual is 0.04817592352628708
dyna residual is 0.04300537332892418
dyna residual is 0.038931746035814285
dyna residual is 0.035629626363515854
-----
after optimization
geo loss is 2.3225592560294217e-09
r_err is 8.027317477399265e-08
t_err is 9.215281870922354e-10
ob_loss is 0.667810320854187
ob_r_err is 14.401904106140137
ob_t_err is 0.4112611711025238
-----
bad optimization!
-----
before optimization
geo loss is 8.863211276022298e-10
r_err is 2.2792971066110113e-08
t_err is 4.88508733464954e-10
ob_loss is 0.07839629799127579
ob_r_err is 0.8747465014457703
ob_t_err is 0.06312759220600128
-----
before, dynamic flow loss is 0.005278346128761768
predicted weight is 0.4469107389450073
predicted dynamic weight is 0.49069181084632874
predicted dynamic flow loss is 0.15877628326416016
predicted flow loss is 1.22505521774292
predicted flow delta is -0.02092924155294895
first residual should be -0.15349794924259186
dyna residual is -0.15349794924259186
dyna residual is -0.15202713012695312
dyna residual is -0.12989366054534912
dyna residual is -0.12809276580810547
dyna residual is -0.10532601177692413
dyna residual is -0.10579773783683777
dyna residual is -0.09888043254613876
dyna residual is -0.09985003620386124
-----
after optimization
geo loss is 8.863211276022298e-10
r_err is 2.2792971066110113e-08
t_err is 4.88508733464954e-10
ob_loss is 0.2721456289291382
ob_r_err is 3.1581714153289795
ob_t_err is 0.21696217358112335
-----
bad optimization!
-----
before optimization
geo loss is 1.830481211051449e-09
r_err is 8.586677324728953e-08
t_err is 3.318234853555424e-10
ob_loss is 0.28088223934173584
ob_r_err is 9.296228408813477
ob_t_err is 0.11838066577911377
-----
before, dynamic flow loss is 1.3775161504745483
predicted weight is 0.24527974426746368
predicted dynamic weight is 0.31037646532058716
predicted dynamic flow loss is 1.4676127433776855
predicted flow loss is 2.6157736778259277
predicted flow delta is -0.04132080078125
first residual should be -0.09009668976068497
dyna residual is -0.09009668976068497
dyna residual is -0.018322516232728958
dyna residual is -0.019365601241588593
dyna residual is -0.019466035068035126
dyna residual is -0.019412683323025703
dyna residual is -0.019416717812418938
dyna residual is -0.01941157691180706
dyna residual is -0.019422238692641258
-----
after optimization
geo loss is 1.830481211051449e-09
r_err is 8.586677324728953e-08
t_err is 3.318234853555424e-10
ob_loss is 0.28119415044784546
ob_r_err is 10.366999626159668
ob_t_err is 0.10005658864974976
-----
bad optimization!
-----
before optimization
geo loss is 1.5505998707254776e-09
r_err is 5.684796633431688e-08
t_err is 5.584158135896189e-10
ob_loss is 0.14309269189834595
ob_r_err is 4.031258583068848
ob_t_err is 0.0727090835571289
-----
before, dynamic flow loss is 0.19630101323127747
predicted weight is 0.6073846817016602
predicted dynamic weight is 0.09126903116703033
predicted dynamic flow loss is 0.46521201729774475
predicted flow loss is 1.3185588121414185
predicted flow delta is 0.010322695598006248
first residual should be -0.2689110040664673
dyna residual is -0.2689110040664673
dyna residual is -0.17687556147575378
dyna residual is -0.1741618514060974
dyna residual is -0.17157544195652008
dyna residual is -0.16987253725528717
dyna residual is -0.17209535837173462
dyna residual is -0.17352713644504547
dyna residual is -0.1738668978214264
-----
after optimization
geo loss is 1.5505998707254776e-09
r_err is 5.684796633431688e-08
t_err is 5.584158135896189e-10
ob_loss is 0.4398684501647949
ob_r_err is 9.736679077148438
ob_t_err is 0.2688632011413574
-----
bad optimization!
-----
before optimization
geo loss is 3.107402557489536e-09
r_err is 6.310225586503293e-08
t_err is 2.006060428882961e-09
ob_loss is 0.12400456517934799
ob_r_err is 0.38452479243278503
ob_t_err is 0.11729292571544647
-----
before, dynamic flow loss is -0.05032649636268616
predicted weight is 0.20319896936416626
predicted dynamic weight is 0.1840149611234665
predicted dynamic flow loss is -0.03746528550982475
predicted flow loss is 3.241529703140259
predicted flow delta is -0.29775404930114746
first residual should be -0.012861221097409725
dyna residual is -0.012861221097409725
dyna residual is 0.14381460845470428
dyna residual is 0.10998975485563278
dyna residual is 0.14616821706295013
dyna residual is 0.10024096071720123
dyna residual is 0.105422742664814
dyna residual is 0.09379999339580536
dyna residual is 0.07908707857131958
-----
after optimization
geo loss is 1.066314396780399e-07
r_err is 8.19135095753154e-07
t_err is 9.233483666548636e-08
ob_loss is 0.44559115171432495
ob_r_err is 6.340862274169922
ob_t_err is 0.33479300141334534
-----
bad optimization!
-----
before optimization
geo loss is 3.424599714918486e-09
r_err is 7.451060213270466e-08
t_err is 2.1241444159159073e-09
ob_loss is 0.11712846904993057
ob_r_err is 0.641351044178009
ob_t_err is 0.10593269765377045
-----
before, dynamic flow loss is 0.2780740559101105
predicted weight is 0.3059931993484497
predicted dynamic weight is 0.23667393624782562
predicted dynamic flow loss is 0.03521997481584549
predicted flow loss is 2.6885504722595215
predicted flow delta is 0.024456333369016647
first residual should be 0.24285408854484558
dyna residual is 0.24285408854484558
dyna residual is 0.004839648958295584
dyna residual is 0.07208319753408432
dyna residual is 0.07140364497900009
dyna residual is 0.07758079469203949
dyna residual is 0.07532576471567154
dyna residual is 0.07683908939361572
dyna residual is 0.07558803260326385
-----
after optimization
geo loss is 3.424599714918486e-09
r_err is 7.451060213270466e-08
t_err is 2.1241444159159073e-09
ob_loss is 0.42495667934417725
ob_r_err is 7.1845316886901855
ob_t_err is 0.2988896369934082
-----
bad optimization!
-----
before optimization
geo loss is 1.8845194293959366e-09
r_err is 1.9973896314695594e-08
t_err is 1.5359091776190326e-09
ob_loss is 0.04357543960213661
ob_r_err is 0.096512570977211
ob_t_err is 0.04189096763730049
-----
before, dynamic flow loss is 0.3363405168056488
predicted weight is 0.16270576417446136
predicted dynamic weight is 0.2280907928943634
predicted dynamic flow loss is 0.5336428880691528
predicted flow loss is 2.9245681762695312
predicted flow delta is 0.3099670708179474
first residual should be -0.19730240106582642
dyna residual is -0.19730240106582642
dyna residual is -0.047112926840782166
dyna residual is 0.0039345333352684975
dyna residual is 0.003990813624113798
dyna residual is 0.004276038613170385
dyna residual is 0.004312248434871435
dyna residual is 0.004345632623881102
dyna residual is 0.00434903334826231
-----
after optimization
geo loss is 1.8845194293959366e-09
r_err is 1.9973896314695594e-08
t_err is 1.5359091776190326e-09
ob_loss is 0.19174164533615112
ob_r_err is 2.574340581893921
ob_t_err is 0.14678725600242615
-----
bad optimization!
-----
before optimization
geo loss is 3.4232532364342205e-09
r_err is 8.881831803364548e-08
t_err is 1.8730812456624335e-09
ob_loss is 0.09637048095464706
ob_r_err is 0.0
ob_t_err is 0.09637048095464706
-----
before, dynamic flow loss is 0.265285849571228
predicted weight is 0.3194240629673004
predicted dynamic weight is 0.1282903105020523
predicted dynamic flow loss is 0.08967451751232147
predicted flow loss is 2.8122148513793945
predicted flow delta is 0.15938088297843933
first residual should be 0.17561128735542297
dyna residual is 0.17561128735542297
dyna residual is 0.7146052718162537
dyna residual is -0.08465186506509781
dyna residual is 0.06357768923044205
dyna residual is -0.0678863450884819
dyna residual is -0.010363838635385036
dyna residual is -0.04697590321302414
dyna residual is -0.018303703516721725
-----
after optimization
geo loss is 3.4232532364342205e-09
r_err is 8.881831803364548e-08
t_err is 1.8730812456624335e-09
ob_loss is 1.2459602355957031
ob_r_err is 25.667522430419922
ob_t_err is 0.7805172801017761
-----
bad optimization!
-----
before optimization
geo loss is 3.121296332508905e-09
r_err is 7.151609793254465e-08
t_err is 1.8731050044351605e-09
ob_loss is 0.03208088502287865
ob_r_err is 0.0
ob_t_err is 0.03208088502287865
-----
before, dynamic flow loss is -0.025643441826105118
predicted weight is 0.029883835464715958
predicted dynamic weight is 0.0548320971429348
predicted dynamic flow loss is 0.4771396815776825
predicted flow loss is 5.200368881225586
predicted flow delta is 0.12168338894844055
first residual should be -0.5027831196784973
dyna residual is -0.5027831196784973
dyna residual is -0.1635877788066864
dyna residual is -0.005497042555361986
dyna residual is -0.03227565065026283
dyna residual is 0.08767373114824295
dyna residual is -0.008832764811813831
dyna residual is 0.11130814999341965
dyna residual is -0.0007681222632527351
-----
after optimization
geo loss is 3.121296332508905e-09
r_err is 7.151609793254465e-08
t_err is 1.8731050044351605e-09
ob_loss is 0.40347999334335327
ob_r_err is 9.453224182128906
ob_t_err is 0.23794929683208466
-----
bad optimization!
-----
before optimization
geo loss is 1.2581551356305454e-09
r_err is 1.6918317413683326e-08
t_err is 9.62874779908418e-10
ob_loss is 0.03514483571052551
ob_r_err is 0.23380492627620697
ob_t_err is 0.03106413409113884
-----
before, dynamic flow loss is 0.01531417015939951
predicted weight is 0.5283198952674866
predicted dynamic weight is 0.4613412916660309
predicted dynamic flow loss is -0.10432622581720352
predicted flow loss is 1.0213505029678345
predicted flow delta is -0.00019435188733041286
first residual should be 0.11964040249586105
dyna residual is 0.11964040249586105
dyna residual is 0.1049681231379509
dyna residual is 0.0928851068019867
dyna residual is 0.0852702260017395
dyna residual is 0.08216425031423569
dyna residual is 0.08013078570365906
dyna residual is 0.07940079271793365
dyna residual is 0.0787217989563942
-----
after optimization
geo loss is 1.2581551356305454e-09
r_err is 1.6918317413683326e-08
t_err is 9.62874779908418e-10
ob_loss is 0.16846594214439392
ob_r_err is 2.7040798664093018
ob_t_err is 0.12125600874423981
-----
bad optimization!
-----
before optimization
geo loss is 7.308938343442151e-09
r_err is 4.379978690849384e-08
t_err is 6.544487618498351e-09
ob_loss is 0.4962708055973053
ob_r_err is 11.16315746307373
ob_t_err is 0.30057293176651
-----
before, dynamic flow loss is 51.59718704223633
predicted weight is 0.20101167261600494
predicted dynamic weight is 0.008234585635364056
predicted dynamic flow loss is 54.1452522277832
predicted flow loss is 4.34768533706665
predicted flow delta is -0.4538308382034302
first residual should be -2.5480611324310303
dyna residual is -2.5480611324310303
dyna residual is -0.9295205473899841
dyna residual is -2.987950086593628
dyna residual is -3.236435651779175
dyna residual is 0.2695607841014862
dyna residual is -1.806187629699707
dyna residual is -1.6938574314117432
dyna residual is -1.5839940309524536
-----
after optimization
geo loss is 7.308938343442151e-09
r_err is 4.379978690849384e-08
t_err is 6.544487618498351e-09
ob_loss is 3.1901044845581055
ob_r_err is 31.95742416381836
ob_t_err is 2.518977642059326
-----
bad optimization!
-----
before optimization
geo loss is 2.27963248278229e-09
r_err is 7.600120710549163e-08
t_err is 9.531611055990652e-10
ob_loss is 0.19086997210979462
ob_r_err is 0.32244613766670227
ob_t_err is 0.18524165451526642
-----
before, dynamic flow loss is 1.2721256017684937
predicted weight is 0.11535967141389847
predicted dynamic weight is 0.15296593308448792
predicted dynamic flow loss is 2.1332664489746094
predicted flow loss is 4.706007480621338
predicted flow delta is 0.14797629415988922
first residual should be -0.8611406683921814
dyna residual is -0.8611406683921814
dyna residual is -2.212921142578125
dyna residual is -1.224881649017334
dyna residual is -0.29944783449172974
dyna residual is -0.4000728726387024
dyna residual is -0.26646333932876587
dyna residual is -0.3433857858181
dyna residual is -0.3721495270729065
-----
after optimization
geo loss is 2.27963248278229e-09
r_err is 7.600120710549163e-08
t_err is 9.531611055990652e-10
ob_loss is 0.730833113193512
ob_r_err is 11.128913879394531
ob_t_err is 0.5347353219985962
-----
bad optimization!
[   120,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,    17.4868,     0.8889,     0.0955,     0.0955,     2.1334,     3.2799,     0.3699,     7.6359,     0.2139,     0.2233,     0.9718,    11.6859,     0.1315,     0.0000,     0.0000,     0.0000,     0.0000,     1.3716,     3.2798,     0.0000,    11.6859,     7.6359,     0.0000, 
-----
before optimization
geo loss is 1.1023092660877865e-08
r_err is 5.075860372016905e-07
t_err is 2.164044721197911e-09
ob_loss is 0.583156168460846
ob_r_err is 3.7890498638153076
ob_t_err is 0.5167592763900757
-----
before, dynamic flow loss is -8.407051086425781
predicted weight is 0.07497423887252808
predicted dynamic weight is 0.11375248432159424
predicted dynamic flow loss is -8.255926132202148
predicted flow loss is 5.966391086578369
predicted flow delta is -0.2399178147315979
first residual should be -0.15112502872943878
dyna residual is -0.15112502872943878
dyna residual is -0.9675056338310242
dyna residual is 0.09140417724847794
dyna residual is 0.8236770033836365
dyna residual is 0.9114335775375366
dyna residual is 0.4128597378730774
dyna residual is 0.9381281137466431
dyna residual is 1.094058632850647
-----
after optimization
geo loss is 1.1023092660877865e-08
r_err is 5.075860372016905e-07
t_err is 2.164044721197911e-09
ob_loss is 0.9991905689239502
ob_r_err is 14.742712020874023
ob_t_err is 0.737810492515564
-----
bad optimization!
-----
before optimization
geo loss is 3.4577771756971742e-09
r_err is 1.2583606689986482e-07
t_err is 1.2615233302426532e-09
ob_loss is 0.07910334318876266
ob_r_err is 2.532029151916504
ob_t_err is 0.03490619361400604
-----
before, dynamic flow loss is -0.0848262831568718
predicted weight is 0.0836140587925911
predicted dynamic weight is 0.31204095482826233
predicted dynamic flow loss is 0.021542996168136597
predicted flow loss is 5.457962989807129
predicted flow delta is -0.269756019115448
first residual should be -0.10636927932500839
dyna residual is -0.10636927932500839
dyna residual is -0.08589967340230942
dyna residual is -0.053692277520895004
dyna residual is -0.024853572249412537
dyna residual is -0.02901836857199669
dyna residual is -0.031223274767398834
dyna residual is -0.03070163168013096
dyna residual is -0.03320957347750664
-----
after optimization
geo loss is 3.4577771756971742e-09
r_err is 1.2583606689986482e-07
t_err is 1.2615233302426532e-09
ob_loss is 0.2875317931175232
ob_r_err is 8.87133502960205
ob_t_err is 0.1325405091047287
-----
bad optimization!
-----
before optimization
geo loss is 1.9328538769514125e-09
r_err is 1.0301297237447216e-07
t_err is 1.3493835215871997e-10
ob_loss is 0.053324803709983826
ob_r_err is 1.4488006830215454
ob_t_err is 0.028037188574671745
-----
before, dynamic flow loss is 0.18659649789333344
predicted weight is 0.02681104466319084
predicted dynamic weight is 0.08320605754852295
predicted dynamic flow loss is -0.15439541637897491
predicted flow loss is 6.691056728363037
predicted flow delta is -1.0292116403579712
first residual should be 0.34099194407463074
dyna residual is 0.34099194407463074
dyna residual is 0.4257851839065552
dyna residual is 0.3292848765850067
dyna residual is 0.3205619156360626
dyna residual is 0.30479657649993896
dyna residual is 0.3047929108142853
dyna residual is 0.3034188449382782
dyna residual is 0.30355438590049744
-----
after optimization
geo loss is 1.9328538769514125e-09
r_err is 1.0301297237447216e-07
t_err is 1.3493835215871997e-10
ob_loss is 0.2129332572221756
ob_r_err is 7.563961029052734
ob_t_err is 0.08082536607980728
-----
bad optimization!
-----
before optimization
geo loss is 5.439972028398188e-09
r_err is 1.0783622883536736e-07
t_err is 3.5578748835973784e-09
ob_loss is 0.16339562833309174
ob_r_err is 1.0020793676376343
ob_t_err is 0.1459018737077713
-----
before, dynamic flow loss is -0.6054549813270569
predicted weight is 0.11641166359186172
predicted dynamic weight is 0.11215749382972717
predicted dynamic flow loss is 0.5019633769989014
predicted flow loss is 5.3557281494140625
predicted flow delta is -0.3342893421649933
first residual should be -1.1074182987213135
dyna residual is -1.1074182987213135
dyna residual is 1.9963626861572266
dyna residual is 2.6470272541046143
dyna residual is 1.618444561958313
dyna residual is 0.5078417658805847
dyna residual is 0.15751339495182037
dyna residual is 0.14212989807128906
dyna residual is 0.13925249874591827
-----
after optimization
geo loss is 5.439972028398188e-09
r_err is 1.0783622883536736e-07
t_err is 3.5578748835973784e-09
ob_loss is 0.6998034715652466
ob_r_err is 12.790641784667969
ob_t_err is 0.4745980203151703
-----
bad optimization!
-----
before optimization
geo loss is 8.46199443849116e-10
r_err is 9.256971189586238e-09
t_err is 6.846348488132037e-10
ob_loss is 0.04501219838857651
ob_r_err is 0.7270471453666687
ob_t_err is 0.032322004437446594
-----
before, dynamic flow loss is 0.19509871304035187
predicted weight is 0.40087541937828064
predicted dynamic weight is 0.33200475573539734
predicted dynamic flow loss is 0.2061767578125
predicted flow loss is 0.7213625311851501
predicted flow delta is 0.019581414759159088
first residual should be -0.011078047566115856
dyna residual is -0.011078047566115856
dyna residual is 4.288183117751032e-05
dyna residual is -0.0009841875871643424
dyna residual is -0.0011827561538666487
dyna residual is -0.0011317555326968431
dyna residual is -0.0011429071892052889
dyna residual is -0.0011392167070880532
dyna residual is -0.001135677332058549
-----
after optimization
geo loss is 8.46199443849116e-10
r_err is 9.256971189586238e-09
t_err is 6.846348488132037e-10
ob_loss is 0.06764774024486542
ob_r_err is 1.2770689725875854
ob_t_err is 0.045356690883636475
-----
bad optimization!
-----
before optimization
geo loss is 3.3494096385311423e-09
r_err is 7.028448578694224e-08
t_err is 2.1227137825263753e-09
ob_loss is 0.12089407444000244
ob_r_err is 0.7341020703315735
ob_t_err is 0.1080799326300621
-----
before, dynamic flow loss is -0.16837123036384583
predicted weight is 0.20070978999137878
predicted dynamic weight is 0.26352784037590027
predicted dynamic flow loss is 0.4333943724632263
predicted flow loss is 3.9682517051696777
predicted flow delta is -0.2654073238372803
first residual should be -0.6017655730247498
dyna residual is -0.6017655730247498
dyna residual is 0.09413833171129227
dyna residual is -0.05345863476395607
dyna residual is -0.07304764539003372
dyna residual is -0.10072245448827744
dyna residual is -0.13644860684871674
dyna residual is -0.10238388180732727
dyna residual is -0.1347210854291916
-----
after optimization
geo loss is 3.3494096385311423e-09
r_err is 7.028448578694224e-08
t_err is 2.1227137825263753e-09
ob_loss is 1.123408555984497
ob_r_err is 16.914316177368164
ob_t_err is 0.8200887441635132
-----
bad optimization!
-----
before optimization
geo loss is 2.247153130241486e-09
r_err is 7.382041644632409e-08
t_err is 9.587438620783928e-10
ob_loss is 0.1946749985218048
ob_r_err is 0.3668583631515503
ob_t_err is 0.1882714182138443
-----
before, dynamic flow loss is 1.1730989217758179
predicted weight is 0.11144345998764038
predicted dynamic weight is 0.15684866905212402
predicted dynamic flow loss is 2.0154292583465576
predicted flow loss is 4.6982245445251465
predicted flow delta is 0.02995182015001774
first residual should be -0.8423303365707397
dyna residual is -0.8423303365707397
dyna residual is -1.9050840139389038
dyna residual is 0.3620211184024811
dyna residual is -0.7090924382209778
dyna residual is -0.3049153685569763
dyna residual is -0.07299083471298218
dyna residual is -0.04972241073846817
dyna residual is -0.013664639554917812
-----
after optimization
geo loss is 2.247153130241486e-09
r_err is 7.382041644632409e-08
t_err is 9.587438620783928e-10
ob_loss is 0.5397902727127075
ob_r_err is 9.90285587310791
ob_t_err is 0.3665319085121155
-----
bad optimization!
-----
before optimization
geo loss is 3.8418783709914806e-09
r_err is 5.85235930827821e-08
t_err is 2.8204489854743997e-09
ob_loss is 0.1684272736310959
ob_r_err is 0.6007018089294434
ob_t_err is 0.15794138610363007
-----
before, dynamic flow loss is -0.16628016531467438
predicted weight is 0.1797858625650406
predicted dynamic weight is 0.12907731533050537
predicted dynamic flow loss is 0.8821091055870056
predicted flow loss is 3.7885215282440186
predicted flow delta is -0.6171231865882874
first residual should be -1.048389196395874
dyna residual is -1.048389196395874
dyna residual is 0.6504629254341125
dyna residual is 0.15635156631469727
dyna residual is -0.03056138940155506
dyna residual is -0.08053082227706909
dyna residual is -0.5834530591964722
dyna residual is -0.4960021376609802
dyna residual is -0.6303511261940002
-----
after optimization
geo loss is 3.8418783709914806e-09
r_err is 5.85235930827821e-08
t_err is 2.8204489854743997e-09
ob_loss is 0.7798429727554321
ob_r_err is 8.714025497436523
ob_t_err is 0.6270785331726074
-----
bad optimization!
-----
before optimization
geo loss is 7.603498941577413e-10
r_err is 3.2750993028685116e-08
t_err is 1.8873724805246184e-10
ob_loss is 0.20225325226783752
ob_r_err is 7.693603515625
ob_t_err is 0.06788688898086548
-----
before, dynamic flow loss is 0.5988554358482361
predicted weight is 0.6334235072135925
predicted dynamic weight is 0.07237561047077179
predicted dynamic flow loss is 0.5050904750823975
predicted flow loss is 1.3094253540039062
predicted flow delta is 0.0004657676036003977
first residual should be 0.09376497566699982
dyna residual is 0.09376497566699982
dyna residual is 0.19267798960208893
dyna residual is 0.10308452695608139
dyna residual is 0.1462104171514511
dyna residual is 0.07641875743865967
dyna residual is 0.08530639111995697
dyna residual is 0.06484109163284302
dyna residual is 0.06979010999202728
-----
after optimization
geo loss is 7.603498941577413e-10
r_err is 3.2750993028685116e-08
t_err is 1.8873724805246184e-10
ob_loss is 0.5686352252960205
ob_r_err is 14.921603202819824
ob_t_err is 0.30694523453712463
-----
bad optimization!
-----
before optimization
geo loss is 7.764628051631917e-09
r_err is 1.5520353713327495e-07
t_err is 5.0558148778634404e-09
ob_loss is 0.5134522318840027
ob_r_err is 6.54823112487793
ob_t_err is 0.39879634976387024
-----
before, dynamic flow loss is 0.003682895330712199
predicted weight is 0.14503546059131622
predicted dynamic weight is 0.14240480959415436
predicted dynamic flow loss is 0.09362094849348068
predicted flow loss is 4.195165634155273
predicted flow delta is -0.09058462828397751
first residual should be -0.08993800729513168
dyna residual is -0.08993800729513168
dyna residual is 0.06768333166837692
dyna residual is 0.11161012947559357
dyna residual is 0.07085064798593521
dyna residual is 0.045495856553316116
dyna residual is 0.06838652491569519
dyna residual is 0.03873932734131813
dyna residual is 0.0470607616007328
-----
after optimization
geo loss is 7.764628051631917e-09
r_err is 1.5520353713327495e-07
t_err is 5.0558148778634404e-09
ob_loss is 3.6497769355773926
ob_r_err is 28.593351364135742
ob_t_err is 3.0520031452178955
-----
bad optimization!
-----
before optimization
geo loss is 1.9139805296219947e-09
r_err is 1.0351628532134782e-07
t_err is 1.0728046229147026e-10
ob_loss is 0.0539090558886528
ob_r_err is 1.4404716491699219
ob_t_err is 0.028766773641109467
-----
before, dynamic flow loss is 0.19806593656539917
predicted weight is 0.024747490882873535
predicted dynamic weight is 0.07574570178985596
predicted dynamic flow loss is -0.18403592705726624
predicted flow loss is 6.543391227722168
predicted flow delta is -1.0514830350875854
first residual should be 0.3821018934249878
dyna residual is 0.3821018934249878
dyna residual is 0.45377928018569946
dyna residual is 0.3191605508327484
dyna residual is 0.3020128607749939
dyna residual is 0.2696685791015625
dyna residual is 0.2667645812034607
dyna residual is 0.26363083720207214
dyna residual is 0.26302018761634827
-----
after optimization
geo loss is 1.9139805296219947e-09
r_err is 1.0351628532134782e-07
t_err is 1.0728046229147026e-10
ob_loss is 0.22023940086364746
ob_r_err is 7.434081077575684
ob_t_err is 0.0903683602809906
-----
bad optimization!
-----
before optimization
geo loss is 1.9498791470340393e-09
r_err is 9.348601537340073e-08
t_err is 3.182404340051903e-10
ob_loss is 0.05418839305639267
ob_r_err is 1.458031415939331
ob_t_err is 0.028739606961607933
-----
before, dynamic flow loss is 0.19439664483070374
predicted weight is 0.026116203516721725
predicted dynamic weight is 0.08119746297597885
predicted dynamic flow loss is -0.3773982524871826
predicted flow loss is 6.720485210418701
predicted flow delta is -1.0131946802139282
first residual should be 0.571794867515564
dyna residual is 0.571794867515564
dyna residual is 0.5839399695396423
dyna residual is 0.42324593663215637
dyna residual is 0.3856467008590698
dyna residual is 0.35472455620765686
dyna residual is 0.3503042757511139
dyna residual is 0.3464250862598419
dyna residual is 0.34592869877815247
-----
after optimization
geo loss is 1.9498791470340393e-09
r_err is 9.348601537340073e-08
t_err is 3.182404340051903e-10
ob_loss is 0.26552993059158325
ob_r_err is 8.866718292236328
ob_t_err is 0.11054764688014984
-----
bad optimization!
-----
before optimization
geo loss is 1.865293253189293e-09
r_err is 8.02461528337517e-08
t_err is 4.647336682150893e-10
ob_loss is 0.055922262370586395
ob_r_err is 1.601542592048645
ob_t_err is 0.027968525886535645
-----
before, dynamic flow loss is 0.1840260922908783
predicted weight is 0.03434696048498154
predicted dynamic weight is 0.10037226974964142
predicted dynamic flow loss is 0.030352337285876274
predicted flow loss is 6.409198760986328
predicted flow delta is -0.6984481811523438
first residual should be 0.15367376804351807
dyna residual is 0.15367376804351807
dyna residual is 0.16249074041843414
dyna residual is 0.15465639531612396
dyna residual is 0.15172016620635986
dyna residual is 0.14980903267860413
dyna residual is 0.14926178753376007
dyna residual is 0.14893782138824463
dyna residual is 0.14884528517723083
-----
after optimization
geo loss is 1.865293253189293e-09
r_err is 8.02461528337517e-08
t_err is 4.647336682150893e-10
ob_loss is 0.16744810342788696
ob_r_err is 6.230438232421875
ob_t_err is 0.05866076797246933
-----
bad optimization!
-----
before optimization
geo loss is 2.9078270902260783e-09
r_err is 9.078191709477323e-08
t_err is 1.3233836249071373e-09
ob_loss is 0.16301533579826355
ob_r_err is 0.27436399459838867
ob_t_err is 0.1582264006137848
-----
before, dynamic flow loss is 1.399062156677246
predicted weight is 0.14908121526241302
predicted dynamic weight is 0.29227522015571594
predicted dynamic flow loss is 2.2475013732910156
predicted flow loss is 5.097537994384766
predicted flow delta is 0.20112141966819763
first residual should be -0.8484393954277039
dyna residual is -0.8484393954277039
dyna residual is -0.6692802906036377
dyna residual is -0.18734054267406464
dyna residual is -0.3212849795818329
dyna residual is -0.12655723094940186
dyna residual is -0.12547700107097626
dyna residual is -0.12563538551330566
dyna residual is -0.12557406723499298
-----
after optimization
geo loss is 2.9078270902260783e-09
r_err is 9.078191709477323e-08
t_err is 1.3233836249071373e-09
ob_loss is 0.40151065587997437
ob_r_err is 6.174793720245361
ob_t_err is 0.293612539768219
-----
bad optimization!
-----
before optimization
geo loss is 1.255810344602537e-09
r_err is 1.4018012528538293e-08
t_err is 1.0111498305320765e-09
ob_loss is 0.019323093816637993
ob_r_err is 0.460709810256958
ob_t_err is 0.011282128281891346
-----
before, dynamic flow loss is -0.019112640991806984
predicted weight is 0.298347532749176
predicted dynamic weight is 0.3539942800998688
predicted dynamic flow loss is -0.051791585981845856
predicted flow loss is 2.37623929977417
predicted flow delta is 0.05781551077961922
first residual should be 0.032678939402103424
dyna residual is 0.032678939402103424
dyna residual is 0.022805776447057724
dyna residual is 0.02448401227593422
dyna residual is 0.016209201887249947
dyna residual is 0.017895827069878578
dyna residual is 0.015259165316820145
dyna residual is 0.015855442732572556
dyna residual is 0.015075846575200558
-----
after optimization
geo loss is 1.255810344602537e-09
r_err is 1.4018012528538293e-08
t_err is 1.0111498305320765e-09
ob_loss is 0.07640422880649567
ob_r_err is 2.0463242530822754
ob_t_err is 0.04068291559815407
-----
bad optimization!
-----
before optimization
geo loss is 2.4114408248010477e-09
r_err is 1.0605371869587543e-07
t_err is 5.604542940851331e-10
ob_loss is 0.09307684004306793
ob_r_err is 0.8214144706726074
ob_t_err is 0.07873852550983429
-----
before, dynamic flow loss is -0.4478875398635864
predicted weight is 0.08980478346347809
predicted dynamic weight is 0.1796002984046936
predicted dynamic flow loss is 0.40605485439300537
predicted flow loss is 4.727158069610596
predicted flow delta is 0.07549604773521423
first residual should be -0.853942334651947
dyna residual is -0.853942334651947
dyna residual is 1.5999852418899536
dyna residual is 0.23365738987922668
dyna residual is -0.6851812601089478
dyna residual is -0.40900444984436035
dyna residual is -0.39686155319213867
dyna residual is -0.4004290699958801
dyna residual is -0.3999702036380768
-----
after optimization
geo loss is 2.4114408248010477e-09
r_err is 1.0605371869587543e-07
t_err is 5.604542940851331e-10
ob_loss is 0.8735722303390503
ob_r_err is 15.346999168395996
ob_t_err is 0.6004667282104492
-----
bad optimization!
-----
before optimization
geo loss is 8.767520043306831e-10
r_err is 3.607267373695322e-08
t_err is 2.471650384361368e-10
ob_loss is 0.19136184453964233
ob_r_err is 7.206684589385986
ob_t_err is 0.0655059963464737
-----
before, dynamic flow loss is 0.5378649830818176
predicted weight is 0.6361801624298096
predicted dynamic weight is 0.07876545190811157
predicted dynamic flow loss is 0.40686285495758057
predicted flow loss is 1.2939666509628296
predicted flow delta is 0.007954702712595463
first residual should be 0.13100218772888184
dyna residual is 0.13100218772888184
dyna residual is 0.22863397002220154
dyna residual is 0.21574383974075317
dyna residual is 0.18348687887191772
dyna residual is 0.17523770034313202
dyna residual is 0.15037289261817932
dyna residual is 0.15631486475467682
dyna residual is 0.14889487624168396
-----
after optimization
geo loss is 8.767520043306831e-10
r_err is 3.607267373695322e-08
t_err is 2.471650384361368e-10
ob_loss is 0.6594645977020264
ob_r_err is 17.400535583496094
ob_t_err is 0.35283878445625305
-----
bad optimization!
-----
before optimization
geo loss is 4.2637342545504e-09
r_err is 3.249085267498231e-08
t_err is 3.6966620875489298e-09
ob_loss is 0.4486541152000427
ob_r_err is 8.804059028625488
ob_t_err is 0.29445528984069824
-----
before, dynamic flow loss is 7.816197395324707
predicted weight is 0.20945066213607788
predicted dynamic weight is 0.01732095144689083
predicted dynamic flow loss is 9.931817054748535
predicted flow loss is 3.9705681800842285
predicted flow delta is -0.1556452363729477
first residual should be -2.115619659423828
dyna residual is -2.115619659423828
dyna residual is -1.2352765798568726
dyna residual is -1.0109227895736694
dyna residual is -3.2708728313446045
dyna residual is -2.458404064178467
dyna residual is -1.002040147781372
dyna residual is -3.46594500541687
dyna residual is -2.6850125789642334
-----
after optimization
geo loss is 4.2637342545504e-09
r_err is 3.249085267498231e-08
t_err is 3.6966620875489298e-09
ob_loss is 9.016456604003906
ob_r_err is 78.46351623535156
ob_t_err is 5.987006664276123
-----
bad optimization!
-----
before optimization
geo loss is 2.6429258781490717e-09
r_err is 1.4405699744202138e-07
t_err is 1.2865711274123726e-10
ob_loss is 0.06152886152267456
ob_r_err is 1.1060057878494263
ob_t_err is 0.04222419857978821
-----
before, dynamic flow loss is -0.013741232454776764
predicted weight is 0.1627919226884842
predicted dynamic weight is 0.25438353419303894
predicted dynamic flow loss is -0.07001356035470963
predicted flow loss is 3.7863175868988037
predicted flow delta is -0.03180408105254173
first residual should be 0.05627232417464256
dyna residual is 0.05627232417464256
dyna residual is 0.11477082222700119
dyna residual is 0.09334476292133331
dyna residual is 0.08836110681295395
dyna residual is 0.07813279330730438
dyna residual is 0.07589255273342133
dyna residual is 0.07231161743402481
dyna residual is 0.07186875492334366
-----
after optimization
geo loss is 2.6429258781490717e-09
r_err is 1.4405699744202138e-07
t_err is 1.2865711274123726e-10
ob_loss is 0.3783566951751709
ob_r_err is 9.49428939819336
ob_t_err is 0.2122543752193451
-----
bad optimization!
-----
before optimization
geo loss is 1.0920355730803522e-09
r_err is 4.3547583317149474e-08
t_err is 3.3198679916246476e-10
ob_loss is 0.08845477551221848
ob_r_err is 3.197455644607544
ob_t_err is 0.03263768181204796
-----
before, dynamic flow loss is 0.07527071982622147
predicted weight is 0.13798528909683228
predicted dynamic weight is 0.48404499888420105
predicted dynamic flow loss is 0.08940151333808899
predicted flow loss is 3.030003070831299
predicted flow delta is -0.12189177423715591
first residual should be -0.014130820520222187
dyna residual is -0.014130820520222187
dyna residual is -0.022141097113490105
dyna residual is 0.10446842759847641
dyna residual is -0.08191175013780594
dyna residual is 0.09087081253528595
dyna residual is -0.018923278898000717
dyna residual is 0.02902548387646675
dyna residual is 0.005605526268482208
-----
after optimization
geo loss is 1.0920355730803522e-09
r_err is 4.3547583317149474e-08
t_err is 3.3198679916246476e-10
ob_loss is 0.4936878979206085
ob_r_err is 10.78703784942627
ob_t_err is 0.30426913499832153
-----
bad optimization!
[   140,  0.0000100]     0.0000,     0.0000,     1.0000,     1.0000,    14.3268,     0.7347,     0.0909,     0.0909,     2.7056,     4.3053,     0.2990,     9.3801,     0.1307,     0.5339,     0.9602,    14.4811,     0.1421,     0.0000,     0.0000,     0.0000,     0.0000,     1.0741,     4.3053,     0.0000,    14.4811,     9.3801,     0.0000, 
-----
before optimization
geo loss is 1.4384561985991695e-08
r_err is 1.3477455240717973e-07
t_err is 1.2032302265652106e-08
ob_loss is 0.233266219496727
ob_r_err is 0.8198833465576172
ob_t_err is 0.21894881129264832
-----
before, dynamic flow loss is 0.19899487495422363
predicted weight is 0.11248745769262314
predicted dynamic weight is 0.2171834260225296
predicted dynamic flow loss is 0.04824789613485336
predicted flow loss is 4.4916558265686035
predicted flow delta is -0.586951494216919
first residual should be 0.15074697136878967
dyna residual is 0.15074697136878967
dyna residual is 0.417797327041626
dyna residual is 0.4665774703025818
dyna residual is 0.40134409070014954
dyna residual is 0.42772263288497925
dyna residual is 0.41821298003196716
dyna residual is 0.42380207777023315
dyna residual is 0.42085427045822144
-----
after optimization
geo loss is 1.4384561985991695e-08
r_err is 1.3477455240717973e-07
t_err is 1.2032302265652106e-08
ob_loss is 0.7188044190406799
ob_r_err is 6.4155402183532715
ob_t_err is 0.6062675714492798
-----
bad optimization!
